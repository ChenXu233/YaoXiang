---
title: 'RFC-005: Automated CVE Security Scanning System'
---

# RFC-005: Automated CVE Security Scanning System

> **Status**: Draft
> **Author**: ChenXu
> **Created Date**: 2025-01-05
> **Last Updated**: 2026-02-12 (Aligned with RFC-010 unified syntax)

## Summary

This RFC proposes establishing an automated CVE (Common Vulnerabilities and Exposures) security scanning system based on **AI-enhanced + GitHub Actions**. Security scans are automatically performed at code commits, dependency changes, and release nodes to detect and alert potential security risks early.

## Motivation

### Why this feature is needed?

Security is increasingly important for open source projects:

1. **Dependency vulnerability risks**: Third-party dependencies used by the project may have known vulnerabilities
2. **Supply chain attacks**: Malicious code may be injected through dependency chains
3. **Timely detection**: Need to quickly assess impact and fix after vulnerability discovery
4. **Compliance requirements**: Enterprise users have compliance requirements for code security

### Current Problems

The project currently has the following security blind spots:

- **Unknown dependencies**: No systematic tracking of Cargo/Rust dependency versions and vulnerability status
- **Manual checking**: Dependency updates and security audits rely on manual checking
- **No CI integration**: No mandatory security checks in CI pipeline
- **Missing alerts**: Unable to timely assess impact when new CVEs are published

## Proposal

### Core Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Security Check Architecture              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚  Code Push  â”‚    â”‚ Dep Change  â”‚    â”‚  Scheduled  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚         â”‚                  â”‚                  â”‚             â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                            â”‚                                â”‚
â”‚                            â–¼                                â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â”‚     GitHub Actions      â”‚                    â”‚
â”‚              â”‚     Automated Workflow  â”‚                    â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                          â”‚                                  â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚          â–¼               â–¼               â–¼                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚   â”‚Dep Vuln Scanâ”‚  â”‚Code Sec   â”‚  â”‚ AI Risk   â”‚           â”‚
â”‚   â”‚(Cargo)    â”‚  â”‚Analysis   â”‚  â”‚Assessment â”‚           â”‚
â”‚   â”‚           â”‚  â”‚(Semgrep)  â”‚  â”‚(LLM)      â”‚           â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                          â”‚                                  â”‚
â”‚                          â–¼                                  â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â”‚   Vulnerability Database + AI Analysis       â”‚
â”‚              â”‚  (NVD + GitHub Advisories                   â”‚
â”‚              â”‚   + Custom Rules)                           â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                          â”‚                                  â”‚
â”‚                          â–¼                                  â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚              â”‚   Security Report + Alert Notification     â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Technology Selection

| Component | Technical Solution | Description |
|-----------|-------------------|-------------|
| Dependency vulnerability scan | `cargo-audit` | Rust official vulnerability database integration |
| Code security analysis | `Semgrep` | Static analysis with custom rule support |
| AI risk assessment | OpenAI API / Claude API | Vulnerability impact analysis and fix suggestions |
| Vulnerability database | NVD + GitHub Advisory DB | Official vulnerability data sources |
| Workflow orchestration | GitHub Actions | Native integration, no extra infrastructure |

### GitHub Actions Workflow Design

#### 1. On-Push Check (`security-check.yml`)

```yaml
# .github/workflows/security-check.yml
name: Security Check

on:
  push:
    branches: [main, develop]
    paths:
      - '**/Cargo.toml'
      - '**/Cargo.lock'
      - 'src/**'
      - 'rust-toolchain*'
  pull_request:
    paths:
      - '**/Cargo.toml'
      - '**/Cargo.lock'
      - 'src/**'

jobs:
  dependency-audit:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Rust
        uses: dtolnay/rust-toolchain@stable
        with:
          toolchain: stable

      - name: Cache dependencies
        uses: actions/cache@v4
        with:
          path: |
            ~/.cargo/bin/
            ~/.cargo/registry/index/
            ~/.cargo/registry/cache/
            target/
          key: ${{ runner.os }}-cargo-${{ hashFiles('**/Cargo.lock') }}
          restore-keys: |
            ${{ runner.os }}-cargo-

      - name: Run cargo-audit
        uses: actions-rs/audit-check@v1
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
        continue-on-error: true

      - name: AI Vulnerability Analysis
        if: failure()
        run: |
          echo "Running AI analysis..."
          # Call AI to analyze vulnerability impact
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}

  code-security:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Run Semgrep
        uses: returntocorp/semgrep-action@v1
        with:
          config: >-
            r/security-audit
            r/lang-rust
        continue-on-error: true

  generate-report:
    needs: [dependency-audit, code-security]
    runs-on: ubuntu-latest
    if: always()
    steps:
      - name: Generate Security Report
        run: |
          echo "## Security Check Report" >> $GITHUB_STEP_SUMMARY
          # Generate Markdown format report
```

#### 2. Scheduled Full Scan (`security-scheduled.yml`)

```yaml
# .github/workflows/security-scheduled.yml
name: Scheduled Security Scan

on:
  schedule:
    # Run daily at midnight UTC
    - cron: '0 0 * * *'
  # Manual trigger
  workflow_dispatch:
    inputs:
      scan_level:
        description: 'Scan Level'
        required: false
        default: 'full'
        type: choice
        options:
          - full
          - dependencies
          - code

jobs:
  daily-scan:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Full Dependency Audit
        run: |
          cargo audit --json > audit_results.json
          # Process JSON results

      - name: Check for Yanked Versions
        run: |
          # Check for yanked versions in Cargo.toml
          cargo update --dry-run | grep yanked

      - name: AI Security Assessment
        run: |
          # AI analyze new vulnerability risks
          python3 ai_security_analysis.py
        env:
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}

      - name: Send Notification
        if: failure()
        uses: slackapi/slack-github-action@v1
        with:
          payload: |
            {
              "text": "ðŸš¨ YaoXiang Security Scan Found New Vulnerabilities",
              "attachments": [...]
            }
```

### AI Enhancement Features

#### Vulnerability Impact Analysis

```python
# ai_vulnerability_analysis.py

import openai
import json

def analyze_vulnerability(vulnerability_data: dict) -> dict:
    """
    Use AI to analyze vulnerability impact scope and fix priority
    """

    prompt = f"""
    Analyze the following security vulnerability information and provide fix suggestions:

    Vulnerability Details:
    - CVE ID: {vulnerability_data['cve_id']}
    - Package: {vulnerability_data['package']}
    - Affected Versions: {vulnerability_data['affected_versions']}
    - Severity: {vulnerability_data['severity']}
    - Description: {vulnerability_data['description']}

    Project Information:
    - Current Version: {vulnerability_data['current_version']}
    - In Critical Path: {vulnerability_data['is_critical_path']}

    Please provide:
    1. Impact Assessment (1-10)
    2. Fix Priority (P0/P1/P2/P3)
    3. Suggested Fix Steps
    4. Temporary Mitigation Measures
    """

    response = openai.ChatCompletion.create(
        model="gpt-4",
        messages=[
            {
                "role": "system",
                "content": "You are a code security expert, focusing on open source project vulnerability analysis and fix recommendations."
            },
            {"role": "user", "content": prompt}
        ],
        temperature=0.3
    )

    return parse_ai_response(response)
```

#### Custom Security Rules

```yaml
# .semgrep/rules/security-audit.yaml

rules:
  - id: yaoxiang-unsafe-ffi
    pattern: |
      extern "C" {
        $FUNC(...)
      }
    message: |
      FFI call detected, please ensure:
      1. Parameters are correctly validated
      2. Memory is correctly freed
      3. Errors are correctly handled
    severity: WARNING
    languages: [rust]

  - id: yaoxiang-dos-risk
    pattern: |
      fn $FUNC(...) {
        ...
        $VAR.clone()
        ...
      }
    message: |
      Potential DoS risk: Note clone operations on large objects
    severity: WARNING
    languages: [rust]
```

### Security Report Format

```markdown
# YaoXiang Security Scan Report

**Scan Time**: 2025-01-05 10:30:00 UTC
**Scan Branch**: main
**Commit Hash**: abc123def456

## Vulnerability Summary

| Severity | Count | Status |
|----------|-------|--------|
| Critical | 0 | None |
| High | 2 | Pending |
| Medium | 5 | Assessed |
| Low | 12 | Monitored |

## Dependency Vulnerabilities

### High - Requires Immediate Action

1. **CVE-2024-XXXXX: package-name**
   - Affected Versions: < 1.2.0
   - Current Version: 1.1.5 (Vulnerable)
   - Fixed Version: 1.2.0
   - AI Risk Assessment: P0 - High Risk

### Medium - Handle This Week

...

## Code Security Issues

...

## AI Analysis Summary

This scan found 2 high-risk vulnerabilities, recommended priority handling...

## Suggested Actions

- [ ] Upgrade `package-name` to 1.2.0
- [ ] Review FFI calls in `module/path/file.rs`
- [ ] Configure Dependabot for automatic dependency updates
```

## Detailed Design

### Integration Points

| Phase | Integration Point | Check Content | Blocking Condition |
|-------|-------------------|---------------|-------------------|
| On Push | PR CI | Dependency vulnerabilities, code security issues | Critical/High |
| On Merge | Merge Check | Complete security scan | Critical/High |
| On Release | Release CI | Full security audit | Any vulnerability |
| Scheduled | Daily Task | New CVE check, dependency updates | Notification |

### Permission Model

```yaml
permissions:
  contents: read
  security-events: write
  checks: write
  issues: write  # Used for creating security alert issues
```

### Notification Strategy

| Event | Notification Method | Recipients |
|-------|--------------------|------------|
| Critical/High Vulnerability | Slack + Email + GitHub Mention | Security team + PR author |
| Medium Vulnerability | GitHub Issue | Code owner |
| Daily Summary | Email | All contributors |
| Fix Complete | GitHub Check | PR participants |

## Trade-offs

### Advantages

- **High automation**: No manual intervention needed, automatic scanning and reporting
- **AI-enhanced**: Intelligent analysis of vulnerability impact, reduced false positives
- **Multi-layer protection**: Dependencies, code, supply chain fully covered
- **CI/CD integration**: Security checks integrated into development workflow
- **Extensible**: Supports custom rules and AI models

### Disadvantages

- **Depends on external services**: AI analysis needs OpenAI/Claude API
- **Cost consideration**: Large number of scans may generate API call costs
- **False positive handling**: Need continuous optimization of rules to reduce false positives
- **Maintenance cost**: Rule library needs continuous updates

## Alternative Solutions

| Solution | Description | Why Not Chosen |
|----------|-------------|----------------|
| Only cargo-audit | Only dependency vulnerability scan | Missing code-level security analysis |
| Commercial security service | Use Snyk, Sonatype, etc. | High cost, poor customizability |
| Pure manual audit | Manually check code and dependencies | Low efficiency, narrow coverage |
| Only Semgrep | Only code static analysis | Missing dependency vulnerability data |

## Implementation Strategy

### Phase Division

1. **Phase 1: Basic Dependency Scanning** (v0.3)
   - Configure `cargo-audit` GitHub Action
   - Establish security report template
   - Add basic Slack/email notification

2. **Phase 2: Code Security Analysis** (v0.4)
   - Configure Semgrep rule set
   - Add custom security rules
   - Establish vulnerability tiered handling process

3. **Phase 3: AI Enhancement** (v0.5)
   - Integrate OpenAI/Claude API
   - Implement vulnerability impact analysis
   - Develop fix suggestion generation

4. **Phase 4: Advanced Features** (v0.6)
   - Automatic fix PR
   - Supply chain security signing
   - Vulnerability bounty integration

### Dependencies

- Phase 1 â†’ Phase 2 â†’ Phase 3 â†’ Phase 4 (sequential dependency)
- No external RFC dependencies

### Risks

| Risk | Impact | Mitigation |
|------|--------|------------|
| API key leak | Security risk | Use GitHub Secrets, rotate regularly |
| Scan timeout | CI delay | Set timeout limits, optimize scan scope |
| Too many false positives | Developer annoyance | Continuously optimize rules, establish whitelist |
| Cost overrun | Financial impact | Set API call limits, use caching |

## Open Questions

- [ ] Which AI provider to use? (OpenAI / Anthropic / Local deployment)
- [ ] Whether to automatically create fix PRs?
- [ ] How to handle supply chain attack detection?
- [ ] Whether to support private dependency repositories?

---

## Appendices

### Appendix A: Security Scan Configuration

```toml
# cargo-audit configuration
# cargo.toml or .cargo/config.toml

[package.metadata.audit]
# Ignore specific vulnerabilities
ignore = ["RUSTSEC-0000-0000"]

# Severity threshold
severity-threshold = "medium"

# Allowed licenses
allow = ["MIT", "Apache-2.0", "BSD-3-Clause"]
```

### Appendix B: GitHub Security Advisory Configuration

```yaml
# .github/advisories.yml
# Custom vulnerability database

exceptions:
  - package: "some-internal-crate"
    vulnerability: "YX-2024-001"
    reason: "Internal use only, mitigation measures taken"
    expires: "2025-06-01"
```

### Appendix C: Glossary

| Term | Definition |
|------|------------|
| CVE | Common Vulnerabilities and Exposures |
| CVSS | Common Vulnerability Scoring System |
| NVD | National Vulnerability Database |
| SAST | Static Application Security Testing |
| SCA | Software Composition Analysis |

---

## References

- [GitHub Advisory Database](https://github.com/advisories)
- [cargo-audit](https://github.com/RustSec/rustsec/tree/main/cargo-audit)
- [Semgrep](https://semgrep.dev/)
- [OWASP Top 10](https://owasp.org/Top10/)
