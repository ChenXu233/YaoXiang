# RFC-008ï¼šRuntime å¹¶å‘æ¨¡å‹ä¸è°ƒåº¦å™¨è„±è€¦è®¾è®¡

> **çŠ¶æ€**: å·²æ¥å—
> **ä½œè€…**: æ™¨ç…¦
> **åˆ›å»ºæ—¥æœŸ**: 2025-01-05
> **æœ€åæ›´æ–°**: 2025-01-05ï¼ˆæ›´æ–°ï¼šè®°å½•è¿è¡Œæ—¶åˆ‡æ¢æœºåˆ¶ã€ç±»å‹çº¦æŸ RFCã€è°ƒåº¦å™¨æ¥å£æ ‡å‡†åŒ–ç­‰æ–°å†³ç­–ï¼‰

> **å‚è€ƒ**:
> - [RFC-001: å¹¶ä½œæ¨¡å‹ä¸é”™è¯¯å¤„ç†ç³»ç»Ÿ](../rfc/001-concurrent-model-error-handling.md)
> - [RFC-003: ç‰ˆæœ¬è§„åˆ’ä¸å®ç°å»ºè®®](../rfc/003-version-planning.md)

## æ‘˜è¦

æœ¬æ–‡æ¡£è®¨è®º Runtime æ¶æ„ä¸­çš„å…³é”®è®¾è®¡é—®é¢˜ï¼š
1. **è¿è¡Œæ—¶åˆ†å±‚è®¾è®¡**ï¼šEmbedded Runtimeï¼ˆåµŒå…¥å¼ï¼‰ vs Standard Runtimeï¼ˆæ ‡å‡†ï¼‰ vs Full Runtimeï¼ˆå®Œæ•´ï¼‰
2. **ç¼–è¯‘ä¸è¿è¡Œåˆ†ç¦»**ï¼šç¼–è¯‘é˜¶æ®µå®Œå…¨ç›¸åŒï¼ŒåŒºåˆ«ä»…åœ¨è¿è¡Œæ—¶æ‰§è¡Œæ–¹å¼
3. **è°ƒåº¦å™¨è„±è€¦è®¾è®¡**ï¼šé€šè¿‡ **æ³›å‹ + æ³¨å…¥** å®ç°è§£è€¦ï¼Œä¿è¯å·¥ä½œçªƒå–ç­‰ç‰¹æ€§ä¸å¯ç”¨æ—¶è§£é‡Šå™¨ä»èƒ½æ­£å¸¸è¿è¡Œ
4. **YaoXiang æ³›å‹ vs Rust Trait**ï¼šåˆ©ç”¨ YaoXiang è¯­è¨€çš„æ³›å‹ç³»ç»Ÿç›´æ¥å®ç°è°ƒåº¦å™¨è„±è€¦ï¼Œæ— éœ€åœ¨è¯­è¨€å±‚é¢å¼•å…¥ Trait æ¦‚å¿µ
5. **DAG çš„æ ¸å¿ƒåœ°ä½**ï¼šä½œä¸ºæƒ°æ€§æ±‚å€¼çš„ä¾èµ–å›¾ï¼ŒDAG å±äº Standard Runtimeï¼ŒåµŒå…¥å¼åœºæ™¯å¯é€‰æ‹©ä¸ä½¿ç”¨

## åŠ¨æœº

### å½“å‰æ¶æ„é—®é¢˜

åœ¨è®¾è®¡ YaoXiang è¿è¡Œæ—¶æ¶æ„æ—¶ï¼Œå­˜åœ¨ä»¥ä¸‹å…³é”®é—®é¢˜éœ€è¦è§£å†³ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å½“å‰æ¶æ„çš„å›°æƒ‘                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  é—®é¢˜ 1ï¼šDAG æ˜¯æ ¸å¿ƒè¿˜æ˜¯å¯é€‰ï¼Ÿ                                   â”‚
â”‚  â”œâ”€â”€ å¦‚æœæ˜¯æ ¸å¿ƒï¼Œå®ƒåº”è¯¥åœ¨ Core Runtime                         â”‚
â”‚  â”œâ”€â”€ å¦‚æœæ˜¯å¯é€‰ï¼Œå¦‚ä½•å®ç°"æ— å¹¶å‘"çš„åŒæ­¥æ‰§è¡Œï¼Ÿ                   â”‚
â”‚  â””â”€â”€ æƒ°æ€§æ±‚å€¼ä¾èµ– DAGï¼Œæ— æ³•ç¦ç”¨                                â”‚
â”‚                                                                 â”‚
â”‚  é—®é¢˜ 2ï¼šè°ƒåº¦å™¨å¦‚ä½•è„±è€¦ï¼Ÿ                                       â”‚
â”‚  â”œâ”€â”€ WorkStealer æ˜¯å¦å¯ä»¥ç¦ç”¨ï¼Ÿ                                 â”‚
â”‚  â”œâ”€â”€ å•çº¿ç¨‹æ¨¡å¼å¦‚ä½•å®ç°ï¼Ÿ                                       â”‚
â”‚  â””â”€â”€ å¦‚ä½•ä¿è¯"æ— è°ƒåº¦å™¨ç‰¹æ€§"æ—¶ VM ä»èƒ½è¿è¡Œï¼Ÿ                    â”‚
â”‚                                                                 â”‚
â”‚  é—®é¢˜ 3ï¼šå¼‚æ­¥/å¹¶å‘çš„å®ç°å±‚çº§                                   â”‚
â”‚  â”œâ”€â”€ @blockï¼ˆL1 åŒæ­¥ï¼‰                                         â”‚
â”‚  â”œâ”€â”€ spawnï¼ˆL2 æ˜¾å¼å¹¶å‘ï¼‰                                      â”‚
â”‚  â””â”€â”€ æ— æ ‡è®°ï¼ˆL3 é€æ˜å¹¶å‘ï¼‰                                     â”‚
â”‚  â””â”€â”€ è¿™äº›ç‰¹æ€§åº”è¯¥åœ¨å“ªä¸€å±‚å®ç°ï¼Ÿ                                â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒçŸ›ç›¾

| çŸ›ç›¾ | æè¿° |
|------|------|
| é€æ˜æ€§ vs å¯æ§æ€§ | å¹¶å‘åº”è¯¥æ˜¯é»˜è®¤è¡Œä¸ºï¼Œä½†ç”¨æˆ·åº”è¯¥èƒ½æ§åˆ¶ |
| æ ¸å¿ƒ vs å¯é€‰ | DAG æ˜¯æ ¸å¿ƒï¼Œä½† WorkStealing æ˜¯ num_workers>1 çš„é«˜çº§ç‰¹æ€§ |
| å•çº¿ç¨‹ vs å¹¶å‘ | å•çº¿ç¨‹æ¨¡å¼ä¸‹å¹¶å‘è¡¨ç°ä¸ºå¼‚æ­¥ï¼ŒåŒæ­¥åªæ˜¯è°ƒåº¦çš„ç‰¹ä¾‹ |

## ææ¡ˆ

### 1. Runtime ä¸‰å±‚æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           YaoXiang è¿è¡Œæ—¶ä¸‰å±‚æ¶æ„                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                           ğŸ“¦ ç¼–è¯‘é˜¶æ®µï¼ˆæ‰€æœ‰æ¨¡å¼ç›¸åŒï¼‰                              â”‚   â”‚
â”‚  â”‚                                                                                  â”‚   â”‚
â”‚  â”‚   Source Code                                                                    â”‚   â”‚
â”‚  â”‚       â”‚                                                                          â”‚   â”‚
â”‚  â”‚       â–¼                                                                          â”‚   â”‚
â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚   â”‚  Lexer  â”‚â”€â–¶â”‚ Parser  â”‚â”€â–¶â”‚TypeCheckâ”‚â”€â–¶â”‚ Codegen â”‚â”€â–¶â”‚  IR / Bytecode      â”‚  â”‚   â”‚
â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â”‚                                                                                  â”‚   â”‚
â”‚  â”‚   âš ï¸ é‡è¦ï¼šç¼–è¯‘é˜¶æ®µå®Œå…¨ç›¸åŒï¼å…±äº«åŒä¸€å¥—ä»£ç                                        â”‚   â”‚
â”‚  â”‚       â€¢ åŒä¸€å¥—è¯­æ³•è§£æï¼ˆLexer + Parserï¼‰                                         â”‚   â”‚
â”‚  â”‚       â€¢ åŒä¸€å¥—ç±»å‹æ£€æŸ¥ï¼ˆTypeCheckï¼‰                                              â”‚   â”‚
â”‚  â”‚       â€¢ åŒä¸€å¥—ä»£ç ç”Ÿæˆï¼ˆCodegenï¼‰                                                â”‚   â”‚
â”‚  â”‚       â€¢ åŒä¸€å¥— IR/Bytecode è¾“å‡º                                                  â”‚   â”‚
â”‚  â”‚                                                                                  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                         â”‚                                              â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚                    â–¼                    â–¼                    â–¼                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚ ğŸŸ¢ Embedded      â”‚   â”‚ ğŸ”µ Standard   â”‚   â”‚ ğŸŸ£ Full          â”‚                     â”‚
â”‚  â”‚                  â”‚   â”‚               â”‚   â”‚                  â”‚                     â”‚
â”‚  â”‚ å³æ—¶æ‰§è¡Œå™¨        â”‚   â”‚ DAG è°ƒåº¦å™¨    â”‚   â”‚ Full è°ƒåº¦å™¨      â”‚                     â”‚
â”‚  â”‚ åŒæ­¥æ‰§è¡Œ         â”‚   â”‚ æƒ°æ€§æ±‚å€¼      â”‚   â”‚ å¹¶è¡Œä¼˜åŒ–         â”‚                     â”‚
â”‚  â”‚ æ— è°ƒåº¦å™¨         â”‚   â”‚ è‡ªåŠ¨å¹¶å‘      â”‚   â”‚ å·¥ä½œçªƒå–         â”‚                     â”‚
â”‚  â”‚ æ—  DAG è°ƒåº¦      â”‚   â”‚               â”‚   â”‚                  â”‚                     â”‚
â”‚  â”‚                  â”‚   â”‚               â”‚   â”‚                  â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚                                                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              å„è¿è¡Œæ—¶è¯¦ç»†è¯´æ˜                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ğŸŸ¢ Embedded Runtimeï¼ˆåµŒå…¥å¼ï¼‰                                                 â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  ç›®æ ‡åœºæ™¯ï¼šWASM / æ¸¸æˆè„šæœ¬ / è§„åˆ™å¼•æ“ / æ•°æ®åº“å­˜å‚¨è¿‡ç¨‹                          â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  ç»„ä»¶ï¼š                                                                       â”‚      â”‚
â”‚  â”‚  â€¢ Value + Allocator + Ownershipï¼ˆå†…å­˜å®‰å…¨ï¼‰                                  â”‚      â”‚
â”‚  â”‚  â€¢ å³æ—¶æ‰§è¡Œå™¨ï¼ˆImmediate Executorï¼‰                                           â”‚      â”‚
â”‚  â”‚  â€¢ âš ï¸ æ—  DAG è°ƒåº¦å™¨                                                           â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  æ‰§è¡Œæ¨¡å¼ï¼š                                                                   â”‚      â”‚
â”‚  â”‚  â€¢ ç¼–è¯‘äº§ç‰©ï¼šIR / Bytecodeï¼ˆå«æƒ°æ€§æ±‚å€¼æ ‡è®°ï¼‰                                   â”‚      â”‚
â”‚  â”‚  â€¢ å³æ—¶æ‰§è¡Œå™¨è¯»å– IRï¼ŒæŒ‰é¡ºåº**åŒæ­¥æ‰§è¡Œ**                                       â”‚      â”‚
â”‚  â”‚  â€¢ è™½ç„¶ä»£ç æ ‡è®°äº†"æƒ°æ€§æ±‚å€¼"ï¼Œä½†å› ä¸ºæ²¡æœ‰è°ƒåº¦å™¨ï¼Œé»˜è®¤åŒæ­¥æ‰§è¡Œ                    â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  ä¼˜åŠ¿ï¼š                                                                       â”‚      â”‚
â”‚  â”‚  â€¢ é«˜æ€§èƒ½ï¼šå³æ—¶æ‰§è¡Œï¼Œæ— è°ƒåº¦å¼€é”€                                                â”‚      â”‚
â”‚  â”‚  â€¢ ä½å†…å­˜ï¼šæ—  DAG å†…å­˜å ç”¨                                                    â”‚      â”‚
â”‚  â”‚  â€¢ å¿«é€Ÿå¯åŠ¨ï¼šæ— éœ€åˆå§‹åŒ–è°ƒåº¦å™¨                                                  â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  ä»£ä»·ï¼š                                                                       â”‚      â”‚
â”‚  â”‚  â€¢ æ”¾å¼ƒæƒ°æ€§æ±‚å€¼                                                                â”‚      â”‚
â”‚  â”‚  â€¢ æ”¾å¼ƒè‡ªåŠ¨å¹¶å‘/å¼‚æ­¥                                                           â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ğŸ”µ Standard Runtimeï¼ˆæ ‡å‡†è¿è¡Œæ—¶ - è¯­è¨€æ ¸å¿ƒï¼‰                                  â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  ç›®æ ‡åœºæ™¯ï¼šWeb æœåŠ¡ / æ•°æ®ç®¡é“ / äº‹ä»¶é©±åŠ¨åº”ç”¨                                   â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  ç»„ä»¶ï¼š                                                                       â”‚      â”‚
â”‚  â”‚  â€¢ Value + Allocator + Ownershipï¼ˆå†…å­˜å®‰å…¨ï¼‰                                  â”‚      â”‚
â”‚  â”‚  â€¢ DAGï¼ˆæƒ°æ€§æ±‚å€¼æ ¸å¿ƒ â˜…ï¼‰                                                      â”‚      â”‚
â”‚  â”‚  â€¢ Schedulerï¼ˆä»»åŠ¡è°ƒåº¦å™¨ï¼‰                                                    â”‚      â”‚
â”‚  â”‚  â€¢ å¹¶ä½œæ¨¡å‹ï¼ˆRFC-001ï¼‰åŸç”Ÿæ”¯æŒå¼‚æ­¥/å¹¶å‘                                        â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  æ‰§è¡Œæ¨¡å¼ï¼š                                                                   â”‚   Ìƒ  â”‚
â”‚  â”‚  â€¢ ç¼–è¯‘äº§ç‰©ï¼šIR / Bytecodeï¼ˆå«æƒ°æ€§æ±‚å€¼æ ‡è®°ï¼‰                                   â”‚      â”‚
â”‚  â”‚  â€¢ DAG è°ƒåº¦å™¨è§£æä¾èµ–å…³ç³»ï¼ŒæŒ‰ä¾èµ–é¡ºåº**æƒ°æ€§æ‰§è¡Œ**                               â”‚      â”‚
â”‚  â”‚  â€¢ å¹¶ä½œæ¨¡å‹è‡ªåŠ¨å¤„ç†å¹¶å‘/å¼‚æ­¥                                                   â”‚      â”‚
â”‚  â”‚  â€¢ âš ï¸ æ— éœ€ async/await è¯­æ³•ç³–ï¼                                               â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  é…ç½®é€‰é¡¹ï¼š                                                                   â”‚      â”‚
â”‚  â”‚  â€¢ num_workers = 1 â†’ å•çº¿ç¨‹å¼‚æ­¥è°ƒåº¦                                           â”‚      â”‚
â”‚  â”‚  â€¢ num_workers > 1 â†’ å¤šçº¿ç¨‹å¹¶è¡Œè°ƒåº¦                                           â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  ğŸŸ£ Full Runtimeï¼ˆå®Œæ•´è¿è¡Œæ—¶ - å¹¶è¡Œä¼˜åŒ–ï¼‰                                      â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  ç›®æ ‡åœºæ™¯ï¼šç§‘å­¦è®¡ç®— / å¤§è§„æ¨¡å¹¶è¡Œå¤„ç†                                           â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  ç»„ä»¶ï¼š                                                                       â”‚      â”‚
â”‚  â”‚  â€¢ Standard Runtime æ‰€æœ‰ç»„ä»¶                                                  â”‚      â”‚
â”‚  â”‚  â€¢ WorkStealerï¼ˆå·¥ä½œçªƒå– - è´Ÿè½½å‡è¡¡ï¼‰                                          â”‚      â”‚
â”‚  â”‚  â€¢ @block æ ‡å‡†åº“ï¼ˆå¼ºåˆ¶åŒæ­¥ï¼‰                                               â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  æ‰§è¡Œæ¨¡å¼ï¼š                                                                   â”‚      â”‚
â”‚  â”‚  â€¢ ç¼–è¯‘äº§ç‰©ï¼šIR / Bytecodeï¼ˆå«æƒ°æ€§æ±‚å€¼æ ‡è®°ï¼‰                                   â”‚      â”‚
â”‚  â”‚  â€¢ Full è°ƒåº¦å™¨ï¼šDAG + WorkStealer                                             â”‚      â”‚
â”‚  â”‚  â€¢ å¤šçº¿ç¨‹å¹¶è¡Œæ‰§è¡Œ + è´Ÿè½½å‡è¡¡                                                   â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â”‚  é…ç½®é€‰é¡¹ï¼š                                                                   â”‚      â”‚
â”‚  â”‚  â€¢ use_work_stealing = true â†’ å¯ç”¨å·¥ä½œçªƒå–                                    â”‚      â”‚
â”‚  â”‚  â€¢ @block å¯ç”¨äºå¼ºåˆ¶åŒæ­¥æ‰§è¡Œï¼Œç¡®ä¿çº¿ç¨‹å®‰å…¨                                     â”‚      â”‚
â”‚  â”‚                                                                               â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              å…³é”®å¯¹æ¯”è¡¨                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                          â”‚
â”‚  é˜¶æ®µ              â”‚ Embedded   â”‚ Standard   â”‚ Full                                    â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚  ç¼–è¯‘              â”‚   ç›¸åŒ     â”‚   ç›¸åŒ     â”‚   ç›¸åŒ                                  â”‚
â”‚  è¯­æ³•è§£æ          â”‚   ç›¸åŒ     â”‚   ç›¸åŒ     â”‚   ç›¸åŒ                                  â”‚
â”‚  ç±»å‹æ£€æŸ¥          â”‚   ç›¸åŒ     â”‚   ç›¸åŒ     â”‚   ç›¸åŒ                                  â”‚
â”‚  IR ç”Ÿæˆ           â”‚   ç›¸åŒ     â”‚   ç›¸åŒ     â”‚   ç›¸åŒ                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                       â”‚
â”‚  è¿è¡Œæ—¶            â”‚ å³æ—¶æ‰§è¡Œ   â”‚ DAG è°ƒåº¦   â”‚ Full è°ƒåº¦                               â”‚
â”‚  æ‰§è¡Œæ¨¡å¼          â”‚ åŒæ­¥       â”‚ æƒ°æ€§+å¹¶å‘   â”‚ å¹¶è¡Œ                                    â”‚
â”‚  å†…å­˜å ç”¨          â”‚ ä½         â”‚ ä¸­         â”‚ é«˜                                      â”‚
â”‚  å¯åŠ¨é€Ÿåº¦          â”‚ å¿«         â”‚ ä¸­         â”‚ ä¸­                                      â”‚
â”‚  å¹¶å‘èƒ½åŠ›          â”‚ æ—          â”‚ è‡ªåŠ¨       â”‚ è‡ªåŠ¨+å¹¶è¡Œ                               â”‚
â”‚  DAG æƒ°æ€§æ±‚å€¼      â”‚ æ—          â”‚ âœ…         â”‚ âœ…                                      â”‚
â”‚  WorkStealer       â”‚ æ—          â”‚ æ—          â”‚ âœ…                                      â”‚
â”‚  @block             â”‚ æ—          â”‚ æ—          â”‚ âœ…                                      â”‚
â”‚                                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. è°ƒåº¦å™¨è„±è€¦è®¾è®¡

#### æ ¸å¿ƒåŸåˆ™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è°ƒåº¦å™¨è„±è€¦æ ¸å¿ƒåŸåˆ™                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  åŸåˆ™ 1ï¼šè°ƒåº¦å™¨å¿…é¡»å­˜åœ¨ï¼Œä½†å¯ä»¥é…ç½®                              â”‚
â”‚  â”œâ”€â”€ num_workers=1   â†’ å•çº¿ç¨‹æ¨¡å¼ï¼Œå¹¶å‘è¡¨ç°ä¸ºå¼‚æ­¥               â”‚
â”‚  â”œâ”€â”€ num_workers=N   â†’ å¤šçº¿ç¨‹æ¨¡å¼ï¼Œè‡ªåŠ¨å¯ç”¨å¹¶å‘                 â”‚
â”‚  â””â”€â”€ WorkStealer     â†’ num_workers>1 æ—¶çš„é«˜çº§ç‰¹æ€§               â”‚
â”‚                                                                 â”‚
â”‚  åŸåˆ™ 2ï¼šåŒæ­¥æ‰§è¡Œæ˜¯è°ƒåº¦çš„ç‰¹ä¾‹                                    â”‚
â”‚  â”œâ”€â”€ ä¸æ˜¯"ç¦ç”¨è°ƒåº¦å™¨"                                           â”‚
â”‚  â”œâ”€â”€ è€Œæ˜¯"ä½¿ç”¨å• worker çš„è°ƒåº¦å™¨"                               â”‚
â”‚  â””â”€â”€ DAG ä»ç”¨äºæƒ°æ€§æ±‚å€¼                                         â”‚
â”‚                                                                 â”‚
â”‚  åŸåˆ™ 3ï¼šVM ä¸è°ƒåº¦å™¨é€šè¿‡ **æ³›å‹** è§£è€¦                           â”‚
â”‚  â”œâ”€â”€ VM ä¸ç›´æ¥ä¾èµ–å…·ä½“è°ƒåº¦å™¨                                     â”‚
â”‚  â”œâ”€â”€ è€Œæ˜¯é€šè¿‡æ³›å‹å‚æ•° `[S]` è°ƒç”¨ï¼ˆç±»å‹çº¦æŸéœ€è¯­è¨€æ‰©å±•ï¼‰           â”‚
â”‚  â””â”€â”€ å¯ä»¥æ³¨å…¥ä¸åŒçš„è°ƒåº¦å™¨å®ç°ï¼ˆè§[é™„å½•Aè®¨è®º3](#é™„å½•aè®¾è®¡è®¨è®ºè®°å½•)ï¼‰â”‚
â”‚                                                                 â”‚
â”‚  åŸåˆ™ 4ï¼šå¼‚æ­¥æ˜¯ DAG çš„å¤©ç„¶ç‰¹æ€§                                   â”‚
â”‚  â”œâ”€â”€ num_workers=1 æ—¶ï¼šä»»åŠ¡æŒ‰ä¾èµ–é¡ºåºå¼‚æ­¥æ‰§è¡Œ                   â”‚
â”‚  â”œâ”€â”€ num_workers>1 æ—¶ï¼šä»»åŠ¡å¹¶è¡Œæ‰§è¡Œ                             â”‚
â”‚  â””â”€â”€ åŒä¸€ä¸ªæ ¸å¿ƒä¸Šä¹Ÿèƒ½ä¿æŒå¼‚æ­¥ï¼Œä¸åŒæ­¥è¯­ä¹‰ä¸€è‡´                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### è°ƒåº¦å™¨æ¥å£è®¾è®¡ï¼šæ³›å‹ + å‡½æ•°ç±»å‹

> **å…³é”®æ´å¯Ÿ**ï¼šYaoXiang è¯­è¨€æœ¬èº«æ”¯æŒæ³›å‹ï¼Œå› æ­¤è°ƒåº¦å™¨è„±è€¦å¯ä»¥ç›´æ¥ä½¿ç”¨ **æ³›å‹å‚æ•°** å®ç°ï¼Œæ— éœ€å¼•å…¥ Trait æ¦‚å¿µã€‚

##### æ–¹æ¡ˆ Aï¼šYaoXiang è¯­è¨€å±‚é¢ï¼ˆæ¨èï¼‰

```yaoxiang
# è°ƒåº¦å™¨æ¥å£ - ä½¿ç”¨ YaoXiang å‡½æ•°ç±»å‹å®šä¹‰
type Scheduler = {
    spawn: (Task) -> TaskId,
    await: (TaskId) -> Result,
    spawn_with_deps: (Task, List[TaskId]) -> TaskId,
    await_all: (List[TaskId]) -> List[Result],
    stats: () -> SchedulerStats,
}

# å•çº¿ç¨‹è°ƒåº¦å™¨å®ç°
SingleThreadScheduler: Scheduler = {
    spawn: (task) => {
        task_queue.push(task)
        generate_task_id()
    },
    await: (task_id) => {
        # å•çº¿ç¨‹ï¼šæŒ‰ä¾èµ–é¡ºåºå¼‚æ­¥æ‰§è¡Œ
        if task = task_queue.pop() {
            execute_task(task)
        } else {
            err("No tasks")
        }
    },
    spawn_with_deps: (task, deps) => {
        for dep in deps { dag.add_edge(dep, task.id) }
        task_queue.push(task)
        task.id
    },
    await_all: (task_ids) => { ... },
    stats: () => { queue_size: task_queue.len() },
}

# å¤šçº¿ç¨‹è°ƒåº¦å™¨å®ç°
MultiThreadScheduler: Scheduler = {
    spawn: (task) => {
        work_queue.push(task)  # çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—
        generate_task_id()
    },
    await: (task_id) => {
        # ç­‰å¾…ä»»åŠ¡å®Œæˆ
        wait_for_completion(task_id)
    },
    spawn_with_deps: (task, deps) => {
        dag.add_dependencies(task.id, deps)
        work_queue.push(task)
    },
    await_all: (task_ids) => { ... },
    stats: () => { workers: get_worker_stats() },
}

# ä½¿ç”¨æ³›å‹åˆ›å»º VM
# æ³¨æ„ï¼šå½“å‰ YaoXiang æ³›å‹è¯­æ³•ä¸æ”¯æŒç±»å‹çº¦æŸ `S: Scheduler`
# éœ€è¦æ‰©å±•è¯­è¨€ç‰¹æ€§æˆ–ä½¿ç”¨å…¶ä»–æ–¹å¼å®ç°è°ƒåº¦å™¨è„±è€¦
# æ–¹æ¡ˆ1ï¼šä½¿ç”¨ç±»å‹å‚æ•°ï¼Œä¾èµ–ç±»å‹æ£€æŸ¥ä¿è¯æ­£ç¡®æ€§
create_vm: [S](scheduler: S) -> VM = (scheduler) => {
    VM(scheduler: scheduler, memory: create_memory(), dag: create_dag())
}

# æ–¹æ¡ˆ2ï¼šä½¿ç”¨é…ç½®å‚æ•°ï¼Œç¼–è¯‘æœŸé€‰æ‹©è°ƒåº¦å™¨ç±»å‹
create_vm_with_config: (config: VMConfig) -> VM = (config) => {
    match config.scheduler_type of
        "single" => VM(scheduler: SingleThreadScheduler, ...)
        "multi"  => VM(scheduler: MultiThreadScheduler(num_workers: config.workers), ...)
}
```

> **âš ï¸ è¯­è¨€ç‰¹æ€§å¾…å®š**ï¼šYaoXiang å½“å‰ä¸æ”¯æŒæ³›å‹ç±»å‹çº¦æŸï¼ˆå¦‚ `S: Scheduler`ï¼‰ã€‚è‹¥éœ€æ­¤ç‰¹æ€§ï¼Œéœ€è¦æ‰©å±•è¯­è¨€è§„èŒƒæˆ–é‡‡ç”¨æ›¿ä»£æ–¹æ¡ˆã€‚

##### æ–¹æ¡ˆ Bï¼šRust å®ç°å±‚é¢ï¼ˆç¼–è¯‘å™¨çš„ Rust å®ç°ï¼‰

```rust
// src/runtime/scheduler/mod.rs

/// è°ƒåº¦å™¨æ¥å£ - é€šè¿‡æ³›å‹çº¦æŸå®ç°è§£è€¦
/// æ³¨æ„ï¼šè¿™æ˜¯ Rust å±‚é¢çš„å®ç°ç»†èŠ‚ï¼Œé YaoXiang è¯­è¨€ç‰¹æ€§
trait Scheduler: Send + Sync {
    fn spawn(&self, task: Arc<dyn Task>) -> TaskId;
    fn await_task(&self, task_id: TaskId) -> Result<Value, RuntimeError>;
    fn spawn_with_deps(&self, task: Arc<dyn Task>, deps: &[NodeId]) -> TaskId;
    fn stats(&self) -> SchedulerStats;
}

/// VM ä½¿ç”¨æ³›å‹çº¦æŸè°ƒåº¦å™¨
struct VM<S: Scheduler> {
    scheduler: Arc<S>,
    bytecode: Bytecode,
    registers: Vec<Value>,
    // ...
}

impl<S: Scheduler> VM<S> {
    fn exec_spawn(&mut self, func_id: FuncId, args: &[Reg]) -> TaskId {
        let task = Task::new(func_id, args);
        self.scheduler.spawn(Arc::new(task))
    }
}

/// å•çº¿ç¨‹è°ƒåº¦å™¨ï¼ˆç”¨äºå•çº¿ç¨‹æ¨¡å¼ï¼Œå¼‚æ­¥æ‰§è¡Œï¼‰
struct SingleThreadScheduler {
    task_queue: VecDeque<Arc<dyn Task>>,
    dag: Arc<Mutex<ComputationDAG>>,
}

impl Scheduler for SingleThreadScheduler {
    fn spawn(&self, task: Arc<dyn Task>) -> TaskId {
        self.task_queue.push_back(task);
        task.id()
    }

    fn await_task(&self, _task_id: TaskId) -> Result<Value, RuntimeError> {
        // å•çº¿ç¨‹ï¼šæŒ‰ä¾èµ–é¡ºåºå¼‚æ­¥æ‰§è¡Œ
        if let Some(task) = self.task_queue.pop_front() {
            task.execute()
        } else {
            Err(RuntimeError::NoTasks)
        }
    }

    fn spawn_with_deps(&self, task: Arc<dyn Task>, deps: &[NodeId]) -> TaskId {
        for &dep in deps {
            self.dag.lock().unwrap().add_edge(dep, task.id());
        }
        self.task_queue.push_back(task);
        task.id()
    }

    fn stats(&self) -> SchedulerStats {
        SchedulerStats { queue_size: self.task_queue.len() }
    }
}

/// å¤šçº¿ç¨‹è°ƒåº¦å™¨ï¼ˆç”¨äºå¹¶å‘æ¨¡å¼ï¼‰
struct MultiThreadScheduler {
    workers: Vec<Worker>,
    dag: Arc<Mutex<ComputationDAG>>,
    #[cfg(feature = "work-stealing")]
    work_stealer: Arc<WorkStealer>,
}

impl Scheduler for MultiThreadScheduler {
    fn spawn(&self, task: Arc<dyn Task>) -> TaskId {
        #[cfg(feature = "work-stealing")]
        {
            self.work_stealer.push_local(task);
        }
        #[cfg(not(feature = "work-stealing"))]
        {
            self.global_queue.push(task);
        }
        task.id()
    }

    // ... å…¶ä»–æ–¹æ³•å®ç°
}
```

> **æ ¸å¿ƒè¦ç‚¹**ï¼š
> - **YaoXiang å±‚é¢**ï¼šä½¿ç”¨æ³›å‹å‚æ•° `[S]` å®ç°è°ƒåº¦å™¨è§£è€¦ï¼ˆç±»å‹çº¦æŸå¾…è¯­è¨€æ‰©å±•ï¼‰
> - **Rust å±‚é¢**ï¼šä½¿ç”¨ trait `Scheduler` ä½œä¸ºæ³›å‹çº¦æŸ
> - ä¸¤è€…è¯­ä¹‰ä¸€è‡´ï¼šç¼–è¯‘æœŸå¤šæ€ï¼Œæ— è¿è¡Œæ—¶å¼€é”€
>
> **âš ï¸ è¯­è¨€ç‰¹æ€§å¾…å®š**ï¼šYaoXiang å½“å‰ä¸æ”¯æŒæ³›å‹ç±»å‹çº¦æŸï¼Œè°ƒåº¦å™¨è„±è€¦éœ€è¦ä»¥ä¸‹æ–¹æ¡ˆä¹‹ä¸€ï¼š
> - æ–¹æ¡ˆ Aï¼šæ‰©å±•è¯­è¨€æ·»åŠ ç±»å‹çº¦æŸè¯­æ³• `[S: Scheduler]`
> - æ–¹æ¡ˆ Bï¼šä½¿ç”¨é…ç½®å‚æ•° + match åˆ†æ”¯é€‰æ‹©è°ƒåº¦å™¨
> - æ–¹æ¡ˆ Cï¼šä½¿ç”¨ Rust trait åœ¨ç¼–è¯‘å™¨å®ç°å±‚å¤„ç†ï¼ˆä¸æš´éœ²ç»™è¯­è¨€å±‚é¢ï¼‰

#### VM ä½¿ç”¨æ³›å‹è°ƒåº¦å™¨

```yaoxiang
# æ–¹æ¡ˆ Aï¼šç†æƒ³è®¾è®¡ï¼ˆéœ€è¦è¯­è¨€æ‰©å±•ç±»å‹çº¦æŸï¼‰
# VM: [S: Scheduler](scheduler: S) -> VM = (scheduler) => { ... }
# single_vm = VM[SingleThreadScheduler](SingleThreadScheduler)
# multi_vm = VM[MultiThreadScheduler](MultiThreadScheduler(num_workers: 4))

# æ–¹æ¡ˆ Bï¼šå½“å‰å¯è¡Œè®¾è®¡ï¼ˆä½¿ç”¨é…ç½® + matchï¼‰
VM: (scheduler: Scheduler) -> VM = (scheduler) => {
    {
        scheduler: scheduler,
        memory: Memory(),
        registers: [],
        execute: ( bytecode ) => { ... },
    }
}

# ä½¿ç”¨é…ç½®åˆ›å»ºä¸åŒç±»å‹çš„ VM
create_vm: (config: VMConfig) -> VM = (config) => {
    scheduler = match config.mode of
        "single" => SingleThreadScheduler()
        "multi"  => MultiThreadScheduler(num_workers: config.workers)
    VM(scheduler: scheduler)
}
```

```rust
// Rust: VM é€šè¿‡æ³›å‹çº¦æŸä½¿ç”¨è°ƒåº¦å™¨
struct VM<S: Scheduler> {
    scheduler: Arc<S>,
    bytecode: Bytecode,
    registers: Vec<Value>,
}

impl<S: Scheduler> VM<S> {
    fn exec_spawn(&mut self, func_id: FuncId, args: &[Reg]) -> TaskId {
        let task = Task::new(func_id, args);
        // é€šè¿‡æ³›å‹æ¥å£æäº¤ä»»åŠ¡
        self.scheduler.spawn(Arc::new(task))
    }

    fn exec_await(&mut self, task_id: Reg, result_reg: Reg) {
        let task_id = self.registers[task_id].as_task_id();
        let result = self.scheduler.await_task(task_id)
            .expect("await failed");
        self.registers[result_reg] = result;
    }
}
```

### 3. å¼‚æ­¥ä¸æ— æ„Ÿå¹¶å‘çš„å®ç°ä½ç½®

#### å¹¶å‘ä¸‰å±‚æ¨¡å‹ï¼ˆRFC-001 æ‰©å±•ï¼‰

> **è¯¦è§**ï¼š[é™„å½•Aè®¨è®º1 - @block ä¸å¼‚æ­¥å®ç°ä½ç½®](#è®¨è®º1-block-ä¸å¼‚æ­¥å®ç°ä½ç½®)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           å¹¶å‘ä¸‰å±‚æ¨¡å‹å®ç°å±‚çº§                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                                 â”‚
â”‚  å±‚çº§  â”‚   æ¨¡å¼        â”‚  è¯­æ³•æ ‡è®°      â”‚  å®ç°ä½ç½®          â”‚  è¯´æ˜            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  L1    â”‚ @block åŒæ­¥   â”‚ `@block`       â”‚ Full Runtime       â”‚ æ ‡å‡†åº“æä¾›       â”‚
â”‚  L2    â”‚ æ˜¾å¼ spawn    â”‚ `spawn`        â”‚ Core Runtime       â”‚ å¼€å‘è€…å¯æ§       â”‚
â”‚  L3    â”‚ é€æ˜å¹¶å‘      â”‚ æ— ï¼ˆé»˜è®¤ï¼‰     â”‚ Core Runtime       â”‚ è‡ªåŠ¨æœ€ä¼˜å¹¶è¡Œ     â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ ¸å¿ƒè¦ç‚¹ï¼š                                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ DAG å¤©ç„¶æ”¯æŒå¼‚æ­¥ï¼ˆnum_workers=1 æ—¶ï¼‰                               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ å¤šçº¿ç¨‹æ—¶è‡ªåŠ¨å¹¶å‘ï¼ˆnum_workers>1 æ—¶ï¼‰                               â”‚   â”‚
â”‚  â”‚  â””â”€â”€ åŒä¸€ä¸ªæ ¸å¿ƒä¸Šä¹Ÿèƒ½å¼‚æ­¥ï¼Œä¿æŒä¸åŒæ­¥è¯­ä¹‰ä¸€è‡´                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           Full Runtimeï¼ˆå¯é€‰ï¼‰                                  â”‚
â”‚                                                                                 â”‚
â”‚  å±‚çº§  â”‚   æ¨¡å¼        â”‚  å®ç°ä½ç½®      â”‚  è¯´æ˜                               â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚  L1    â”‚ @block        â”‚ Full Runtime   â”‚ å¼ºåˆ¶æ€¥åˆ‡æ±‚å€¼ï¼Œç”±æ ‡å‡†åº“æä¾›         â”‚
â”‚  L4    â”‚ WorkStealer  â”‚ Full Runtime   â”‚ num_workers>1 æ—¶çš„è´Ÿè½½å‡è¡¡         â”‚
â”‚  L5    â”‚ é«˜çº§ async   â”‚ Full Runtime   â”‚ async/await è¯­æ³•ç³–                 â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  æ ¸å¿ƒè¦ç‚¹ï¼š                                                              â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ @block æ˜¯æ ‡å‡†åº“åŠŸèƒ½ï¼Œä¸æ˜¯è¯­è¨€å†…ç½®                               â”‚   â”‚
â”‚  â”‚  â”œâ”€â”€ WorkStealer æ˜¯ num_workers>1 çš„é«˜çº§ç‰¹æ€§                           â”‚   â”‚
â”‚  â”‚  â””â”€â”€ Core Runtime ä¸ä¾èµ–è¿™äº›ç‰¹æ€§ä¹Ÿèƒ½æ­£å¸¸è¿è¡Œ                            â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### æ— æ„Ÿå¹¶å‘å®ç°

```yaoxiang
# L3: é€æ˜å¹¶å‘ï¼ˆé»˜è®¤è¡Œä¸ºï¼‰
# ä»£ç çœ‹èµ·æ¥æ˜¯åŒæ­¥çš„ï¼Œä½†è¿è¡Œæ—¶è‡ªåŠ¨å¹¶è¡Œ/å¼‚æ­¥æ‰§è¡Œ

# num_workers=1 æ—¶ï¼šå¼‚æ­¥æ‰§è¡Œ
# num_workers>1 æ—¶ï¼šå¹¶è¡Œæ‰§è¡Œ

data1 = fetch_data("api1")  # åˆ›å»º DAG èŠ‚ç‚¹ï¼Œä¸é˜»å¡
data2 = fetch_data("api2")  # åˆ›å»º DAG èŠ‚ç‚¹ï¼Œä¸é˜»å¡

# å½“ä½¿ç”¨ data1 æˆ– data2 æ—¶ï¼Œè§¦å‘æ±‚å€¼
# è¿è¡Œæ—¶è‡ªåŠ¨é€‰æ‹©å¼‚æ­¥æˆ–å¹¶è¡Œç­–ç•¥

result = process(data1, data2)  # å®Œæˆåå¤„ç†
```

#### @block å®ç°ï¼ˆæ ‡å‡†åº“ï¼‰

```yaoxiang
# @block ç”±æ ‡å‡†åº“æä¾›
use std::runtime::block

# ä½¿ç”¨ @block å¼ºåˆ¶æ€¥åˆ‡æ±‚å€¼
@block
fetch_sync: (String) -> JSON = (url) => {
    HTTP.get(url).json()  # å¼ºåˆ¶æ€¥åˆ‡æ±‚å€¼ï¼Œä¸è¿›å…¥ DAG æƒ°æ€§é˜Ÿåˆ—
    HTTP.get(url).json()  # å¼ºåˆ¶æ€¥åˆ‡æ±‚å€¼
    HTTP.get(url).json()
    HTTP.get(url).json()
}
```

### 4. æ ¸å¿ƒè®¾è®¡å†³ç­–

#### å†³ç­– 1ï¼šè°ƒåº¦å™¨è„±è€¦æ–¹æ¡ˆé€‰æ‹©

> **å†³è®®**ï¼šé‡‡ç”¨æ–¹æ¡ˆ C'ï¼ˆ**æ³›å‹ + æ³¨å…¥**ï¼‰
> **è¯¦è§**ï¼š[é™„å½•Aè®¨è®º3 - è°ƒåº¦å™¨è„±è€¦æ–¹æ¡ˆé€‰æ‹©](#è®¨è®º3è°ƒåº¦å™¨è„±è€¦æ–¹æ¡ˆé€‰æ‹©)

| æ–¹æ¡ˆ | æè¿° | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|------|
| ~~A: æ¡ä»¶ç¼–è¯‘~~ | ~~#[cfg] æ§åˆ¶ä»£ç è·¯å¾„~~ | ~~é›¶è¿è¡Œæ—¶å¼€é”€~~ | ~~ç»´æŠ¤ä¸¤ä»½ä»£ç ~~ |
| ~~B: è¿è¡Œæ—¶åˆ†æ”¯~~ | ~~if enabled { ... } else { ... }~~ | ~~å•äºŒè¿›åˆ¶~~ | ~~ä¸€ç‚¹å¼€é”€~~ |
| **C': æ³›å‹ + æ³¨å…¥** | **ä½¿ç”¨ YaoXiang æ³›å‹å‚æ•°** | **æ¸…æ™°è§£è€¦ã€å•äºŒè¿›åˆ¶ã€é›¶å¼€é”€ã€æ— éœ€ Trait** | **ç¼–è¯‘æœŸç¡®å®šè°ƒåº¦å™¨ç±»å‹** |

> **å…³é”®æ´å¯Ÿ**ï¼ˆ2025-01-05 @æ™¨ç…¦ï¼‰ï¼š
> - YaoXiang è¯­è¨€æœ¬èº«æ”¯æŒæ³›å‹ï¼Œæ— éœ€å¼•å…¥ Trait æ¦‚å¿µ
> - ä½¿ç”¨æ³›å‹å‚æ•° `[S]` å®ç°è°ƒåº¦å™¨è„±è€¦ï¼ˆç±»å‹çº¦æŸéœ€è¯­è¨€æ‰©å±•ï¼‰
> - ç¼–è¯‘æœŸå¤šæ€ï¼Œæ— è¿è¡Œæ—¶å¼€é”€

#### å†³ç­– 2ï¼šåŒæ­¥æ‰§è¡Œçš„å®ç°

> **å†³è®®**ï¼šåŒæ­¥åªæ˜¯è°ƒåº¦çš„ç‰¹ä¾‹
> **è¯¦è§**ï¼š[é™„å½•Aè®¨è®º2 - å•çº¿ç¨‹æ¨¡å¼å®ç°](#è®¨è®º2å•çº¿ç¨‹æ¨¡å¼å®ç°)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŒæ­¥ vs è°ƒåº¦çš„å…³ç³»                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  è¯¯è§£ï¼šç¦ç”¨è°ƒåº¦å™¨                                                â”‚
â”‚  âŒ scheduler.disabled = true                                   â”‚
â”‚  âŒ if concurrency_disabled { é¡ºåºæ‰§è¡Œ }                        â”‚
â”‚                                                                 â”‚
â”‚  æ­£ç¡®ï¼šåŒæ­¥æ˜¯è°ƒåº¦çš„ç‰¹ä¾‹                                         â”‚
â”‚  âœ… scheduler = SingleThreadScheduler::new()                    â”‚
â”‚  âœ… VM é€šè¿‡ Trait æ¥å£ä½¿ç”¨è°ƒåº¦å™¨                                â”‚
â”‚  âœ… è°ƒåº¦å™¨å§‹ç»ˆå­˜åœ¨ï¼Œåªæ˜¯ num_workers=1                          â”‚
â”‚  âœ… å•çº¿ç¨‹æ¨¡å¼ä¸‹å¹¶å‘è¡¨ç°ä¸ºå¼‚æ­¥                                  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. æ ¸å¿ƒé—®é¢˜è®¨è®º

#### é—®é¢˜ 1ï¼šDAG åº”è¯¥åœ¨å“ªä¸€å±‚ï¼Ÿ

> **å·²å†³è®®**ï¼šDAG å±äº Core Runtime

| å±‚çº§ | åŒ…å« | è¯´æ˜ |
|------|------|------|
| Core Runtime | âœ… DAG | æƒ°æ€§æ±‚å€¼æ ¸å¿ƒï¼Œå¿…é¡»å­˜åœ¨ |
| Core Runtime | âœ… Scheduler | ä»»åŠ¡è°ƒåº¦æ ¸å¿ƒï¼Œå¿…é¡»å­˜åœ¨ |
| Full Runtime | âŒ WorkStealer | num_workers>1 æ—¶çš„è´Ÿè½½å‡è¡¡ï¼Œå¯é€‰ |

---

#### é—®é¢˜ 2ï¼šå¼‚æ­¥æ”¯æŒå¦‚ä½•å®ç°ï¼Ÿ

> **å·²å†³è®®**ï¼šDAG å¤©ç„¶æ”¯æŒå¼‚æ­¥

| é…ç½® | è¡Œä¸º |
|------|------|
| num_workers=1 | ä»»åŠ¡æŒ‰ DAG ä¾èµ–é¡ºåº**å¼‚æ­¥**æ‰§è¡Œ |
| num_workers>1 | ä»»åŠ¡**å¹¶è¡Œ**æ‰§è¡Œï¼Œå¯é€‰ WorkStealer |

---

#### é—®é¢˜ 3ï¼š@block çš„å®ç°ä½ç½®ï¼Ÿ

> **å·²å†³è®®**ï¼š@block ç”±æ ‡å‡†åº“æä¾›

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    @block å®ç°ä½ç½®                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  âŒ ä¸æ˜¯è¯­è¨€å†…ç½®è¯­æ³•                                            â”‚
â”‚  âœ… æ˜¯æ ‡å‡†åº“æä¾›çš„åŠŸèƒ½                                          â”‚
â”‚  âœ… ä½¿ç”¨æ–¹å¼ï¼šblocking::block(|| { ... })                       â”‚
â”‚                                                                 â”‚
â”‚  æ•ˆæœï¼š                                                          â”‚
â”‚  â”œâ”€â”€ å¼ºåˆ¶å‡½æ•°å†…æ‰€æœ‰è¯­å¥æ€¥åˆ‡æ±‚å€¼                                 â”‚
â”‚  â”œâ”€â”€ ä¸ä¼šè¿›å…¥ DAG æƒ°æ€§é˜Ÿåˆ—                                      â”‚
â”‚  â””â”€â”€ è¡¨ç°ä¸ºåŒæ­¥æ‰§è¡Œï¼Œä¸ä¼šè¿›è¡Œè°ƒåº¦                               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### é—®é¢˜ 4ï¼šWorkStealer æ˜¯å¦åœ¨ Core Runtimeï¼Ÿ

> **å·²å†³è®®**ï¼šWorkStealer æ˜¯ Full Runtime é«˜çº§ç‰¹æ€§

| ç»„ä»¶ | å±‚çº§ | åŸå›  |
|------|------|------|
| DAG | Core Runtime | æƒ°æ€§æ±‚å€¼å¿…éœ€ |
| Scheduler | Core Runtime | ä»»åŠ¡è°ƒåº¦å¿…éœ€ |
| WorkStealer | Full Runtime | num_workers>1 æ—¶çš„è´Ÿè½½å‡è¡¡ï¼Œå¯é€‰ |

---

## è¯¦ç»†è®¾è®¡

### æ–‡ä»¶ç»“æ„

```
src/
â”œâ”€â”€ core/                          # Core ç»„ä»¶ï¼ˆæ‰€æœ‰è¿è¡Œæ—¶å…±äº«ï¼‰
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ value.rs                   # å€¼ç±»å‹
â”‚   â”œâ”€â”€ allocator.rs               # å†…å­˜åˆ†é…
â”‚   â””â”€â”€ ownership.rs               # æ‰€æœ‰æƒæ¨¡å‹
â”‚
â”œâ”€â”€ frontend/                      # å‰ç«¯ç»„ä»¶ï¼ˆæ‰€æœ‰è¿è¡Œæ—¶å…±äº«ï¼‰
â”‚   â”œâ”€â”€ lexer/                     # è¯æ³•åˆ†æ
â”‚   â”œâ”€â”€ parser/                    # è¯­æ³•è§£æ
â”‚   â””â”€â”€ typecheck/                 # ç±»å‹æ£€æŸ¥
â”‚
â”œâ”€â”€ codegen/                       # ä»£ç ç”Ÿæˆï¼ˆæ‰€æœ‰è¿è¡Œæ—¶å…±äº«ï¼‰
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ ir.rs                      # IR å®šä¹‰
â”‚   â””â”€â”€ bytecode.rs                # å­—èŠ‚ç ç”Ÿæˆ
â”‚
â”œâ”€â”€ embedded/                      # ğŸŸ¢ Embedded Runtimeï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ mod.rs
â”‚   â””â”€â”€ executor.rs                # å³æ—¶æ‰§è¡Œå™¨ï¼ˆæ—  DAG è°ƒåº¦ï¼‰
â”‚
â”œâ”€â”€ runtime/                       # ğŸ”µ Standard Runtimeï¼ˆæ ‡å‡†ï¼‰
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ dag/                       # DAG æ ¸å¿ƒï¼ˆæƒ°æ€§æ±‚å€¼ï¼‰
â”‚   â”‚   â”œâ”€â”€ mod.rs
â”‚   â”‚   â”œâ”€â”€ trait.rs               # DAG Trait
â”‚   â”‚   â””â”€â”€ computation.rs
â”‚   â””â”€â”€ scheduler/                 # è°ƒåº¦å™¨
â”‚       â”œâ”€â”€ mod.rs
â”‚       â”œâ”€â”€ trait.rs               # Scheduler Trait
â”‚       â”œâ”€â”€ single_thread.rs       # å•çº¿ç¨‹å®ç°ï¼ˆå¼‚æ­¥è°ƒåº¦ï¼‰
â”‚       â””â”€â”€ multi_thread.rs        # å¤šçº¿ç¨‹å®ç°ï¼ˆå¹¶è¡Œè°ƒåº¦ï¼‰
â”‚
â”œâ”€â”€ full/                          # ğŸŸ£ Full Runtimeï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ mod.rs
â”‚   â”œâ”€â”€ work_stealer.rs            # å·¥ä½œçªƒå–ï¼ˆé«˜çº§ç‰¹æ€§ï¼‰
â”‚   â””â”€â”€ block.rs                # @block æ ‡å‡†åº“å®ç°
â”‚
â””â”€â”€ vm/                            # å­—èŠ‚ç è§£é‡Šå™¨
    â”œâ”€â”€ mod.rs
    â””â”€â”€ executor.rs                # é€šè¿‡ Trait è°ƒç”¨è¿è¡Œæ—¶
```

### ç‰¹æ€§é…ç½®

```rust
// Cargo.toml
[features]
default = ["runtime"]              # é»˜è®¤å¯ç”¨æ ‡å‡†è¿è¡Œæ—¶
embedded = []                      # åµŒå…¥å¼æ¨¡å¼ï¼ˆæ—  DAG è°ƒåº¦ï¼‰
full-runtime = ["runtime"]         # å®Œæ•´è¿è¡Œæ—¶ï¼ˆéœ€è¦ runtimeï¼‰
work-stealing = ["full-runtime"]   # å·¥ä½œçªƒå–ï¼ˆéœ€è¦ full-runtimeï¼‰

// ä½¿ç”¨ç¤ºä¾‹
// åµŒå…¥å¼ï¼šyaoxiang --embedded script.yx
// æ ‡å‡†ï¼šyaoxiang script.yx
// å®Œæ•´ï¼šyaoxiang --full-runtime script.yx
```

### é…ç½®æ–¹å¼

```rust
// Cargo.toml
[features]
default = ["core-runtime", "vm", "stdlib"]
core-runtime = []      # Core Runtime å§‹ç»ˆå¯ç”¨
full-runtime = []      # Full Runtime å¯é€‰
work-stealing = []     # å·¥ä½œçªƒå–ï¼ˆéœ€è¦ full-runtimeï¼‰

// è°ƒåº¦å™¨é…ç½®
pub enum SchedulerConfig {
    /// å•çº¿ç¨‹æ¨¡å¼ï¼šnum_workers=1ï¼Œå¹¶å‘è¡¨ç°ä¸ºå¼‚æ­¥
    SingleThread {
        /// æ˜¯å¦å¯ç”¨ DAGï¼ˆå§‹ç»ˆå¯ç”¨ï¼‰
        enable_dag: bool = true,
    },
    /// å¤šçº¿ç¨‹æ¨¡å¼ï¼šnum_workers>1ï¼Œå¯é€‰å¯ç”¨å·¥ä½œçªƒå–
    MultiThread {
        num_workers: usize,
        #[cfg(feature = "work-stealing")]
        use_work_stealing: bool,
    },
}
```

## æƒè¡¡

### ä¼˜ç‚¹

- **æ¸…æ™°çš„ä¸‰å±‚åˆ†å±‚**ï¼šEmbedded / Standard / Full
- **ç¼–è¯‘ä¸è¿è¡Œåˆ†ç¦»**ï¼šå‰ç«¯ä»£ç å®Œå…¨å¤ç”¨ï¼Œä»…è¿è¡Œæ—¶ä¸åŒ
- **è‰¯å¥½çš„è§£è€¦**ï¼šé€šè¿‡ **æ³›å‹** æ¥å£ï¼ˆæ–¹æ¡ˆ C'ï¼‰
- **çµæ´»æ€§**ï¼šå•äºŒè¿›åˆ¶æ”¯æŒå¤šç§æ¨¡å¼
- **é›¶è¿è¡Œæ—¶å¼€é”€**ï¼šç¼–è¯‘æœŸå¤šæ€ï¼Œæ— éœ€ trait å¯¹è±¡
- **ä¸€è‡´æ€§**ï¼šåŒæ­¥åªæ˜¯è°ƒåº¦çš„ç‰¹ä¾‹
- **é«˜æ€§èƒ½**ï¼šåµŒå…¥å¼å³æ—¶æ‰§è¡Œï¼Œæ— è°ƒåº¦å¼€é”€
- **å¯æ‰©å±•**ï¼šWorkStealer ä½œä¸º Full Runtime å¯é€‰ç‰¹æ€§
- **åµŒå…¥å¼å‹å¥½**ï¼šé«˜æ€§èƒ½ + ä½å†…å­˜å ç”¨ + å¿«é€Ÿå¯åŠ¨

### ç¼ºç‚¹

- **åˆå§‹å¤æ‚åº¦**ï¼šéœ€è¦å®šä¹‰è°ƒåº¦å™¨æ¥å£å’Œå¤šç§è¿è¡Œæ—¶å˜ä½“
- **è¿è¡Œæ—¶é…ç½®**ï¼šéœ€è¦å¤„ç†ä¸åŒçš„è¿è¡Œæ—¶æ¨¡å¼
- **åµŒå…¥å¼ä»£ä»·**ï¼šæ”¾å¼ƒæƒ°æ€§æ±‚å€¼å’Œè‡ªåŠ¨å¹¶å‘
- **ç¼–è¯‘æœŸç»‘å®š**ï¼šè°ƒåº¦å™¨ç±»å‹åœ¨ç¼–è¯‘æœŸç¡®å®šï¼Œè¿è¡Œæ—¶æ— æ³•åˆ‡æ¢

## æ›¿ä»£æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šçº¯æ¡ä»¶ç¼–è¯‘

```rust
#[cfg(not(feature = "concurrency"))]
fn spawn_task(task: Arc<Task>) {
    // å•çº¿ç¨‹ï¼šç›´æ¥æ‰§è¡Œ
    task.execute();
}

#[cfg(feature = "concurrency")]
fn spawn_task(task: Arc<Task>) {
    // å¤šçº¿ç¨‹ï¼šæäº¤åˆ°è°ƒåº¦å™¨
    SCHEDULER.spawn(task);
}
```

**ç¼ºç‚¹**ï¼šéœ€è¦ç»´æŠ¤ä¸¤ä»½ä»£ç ï¼Œé…ç½®æ›´æ”¹éœ€è¦é‡æ–°ç¼–è¯‘

### æ–¹æ¡ˆ 2ï¼šç¦ç”¨è°ƒåº¦å™¨

```rust
struct VM {
    #[cfg(not(feature = "concurrency"))]
    scheduler: (),

    #[cfg(feature = "concurrency")]
    scheduler: Arc<Scheduler>,
}
```

**ç¼ºç‚¹**ï¼šå¼•å…¥æ¡ä»¶ç¼–è¯‘çš„å¤æ‚åº¦ï¼Œç ´åæ¶æ„ä¸€è‡´æ€§

## å®ç°ç­–ç•¥

### é˜¶æ®µ 1ï¼šåŸºç¡€æ¶æ„ï¼ˆStandard Runtimeï¼‰

1. å®ç°å‰ç«¯ç»„ä»¶å…±äº«ï¼ˆLexer + Parser + TypeCheckï¼‰
2. å®šä¹‰ `Scheduler` æ¥å£ï¼ˆ**æ³›å‹çº¦æŸ**ï¼Œæ–¹æ¡ˆ C'ï¼‰
3. å®ç° `SingleThreadScheduler`ï¼ˆå¼‚æ­¥è°ƒåº¦ï¼‰
4. è¿ç§» DAG åˆ° Runtime å±‚
5. **å†³ç­–**ï¼šåŒæ­¥æ˜¯è°ƒåº¦çš„ç‰¹ä¾‹ï¼ˆæ–¹æ¡ˆ Bï¼‰
6. å®ç° Standard Runtimeï¼ˆWeb æœåŠ¡/æ•°æ®ç®¡é“åœºæ™¯ï¼‰

### é˜¶æ®µ 2ï¼šEmbedded Runtimeï¼ˆåµŒå…¥å¼ï¼‰

1. å®ç°å³æ—¶æ‰§è¡Œå™¨ï¼ˆImmediate Executorï¼‰
2. å®ç° Embedded Runtime ç»„ä»¶
3. é…ç½®ç³»ç»Ÿæ”¯æŒ `--embedded` æ¨¡å¼
4. **å†³ç­–**ï¼šåµŒå…¥å¼ä½¿ç”¨åŒä¸€å¥—å‰ç«¯ä»£ç ï¼Œå³æ—¶æ‰§è¡Œ
5. **å†³ç­–**ï¼šåµŒå…¥å¼æ”¾å¼ƒ DAG è°ƒåº¦ï¼Œè·å¾—é«˜æ€§èƒ½ + ä½å ç”¨
6. ç›®æ ‡åœºæ™¯ï¼šWASM / æ¸¸æˆè„šæœ¬ / è§„åˆ™å¼•æ“

### é˜¶æ®µ 3ï¼šFull Runtimeï¼ˆå¹¶è¡Œä¼˜åŒ–ï¼‰

1. å®ç° `MultiThreadScheduler`ï¼ˆå¹¶è¡Œè°ƒåº¦ï¼‰
2. **å†³ç­–**ï¼šWorkStealer æ˜¯é«˜çº§ç‰¹æ€§
3. å®ç° WorkStealerï¼ˆFull Runtimeï¼‰
4. å®ç° @block æ ‡å‡†åº“
5. é…ç½®ç³»ç»Ÿæ”¯æŒ `--full-runtime` æ¨¡å¼
6. ç›®æ ‡åœºæ™¯ï¼šç§‘å­¦è®¡ç®— / å¤§è§„æ¨¡å¹¶è¡Œå¤„ç†

## å¼€æ”¾é—®é¢˜

```markdown
# å·²å†³è®®é—®é¢˜
- [x] DAG æ˜¯å¦åº”è¯¥å±äº Standard Runtimeï¼Ÿï¼ˆå†³è®®ï¼šæ˜¯ï¼ŒåµŒå…¥å¼é™¤å¤–ï¼‰
- [x] WorkStealer å¦‚ä½•ä¿è¯ä¸å¯ç”¨æ—¶è§£é‡Šå™¨ä»èƒ½è¿è¡Œï¼Ÿï¼ˆå†³è®®ï¼š**æ³›å‹ + æ³¨å…¥**ï¼Œæ–¹æ¡ˆ C'ï¼‰
- [x] å•çº¿ç¨‹æ¨¡å¼çš„æ­£ç¡®å®ç°æ–¹å¼ï¼Ÿï¼ˆå†³è®®ï¼šåŒæ­¥æ˜¯è°ƒåº¦çš„ç‰¹ä¾‹ï¼Œæ–¹æ¡ˆ Bï¼‰
- [x] å¼‚æ­¥/å¹¶å‘çš„å®ç°ä½ç½®ï¼Ÿï¼ˆå†³è®®ï¼šDAG å¤©ç„¶æ”¯æŒå¼‚æ­¥ï¼‰
- [x] @block çš„å®ç°ä½ç½®ï¼Ÿï¼ˆå†³è®®ï¼šæ ‡å‡†åº“æä¾›ï¼‰
- [x] WorkStealer æ˜¯å¦åœ¨ Core Runtimeï¼Ÿï¼ˆå†³è®®ï¼šFull Runtimeï¼‰
- [x] åµŒå…¥å¼è¿è¡Œæ—¶å¦‚ä½•è®¾è®¡ï¼Ÿï¼ˆå†³è®®ï¼šå³æ—¶æ‰§è¡Œï¼Œæ—  DAG è°ƒåº¦ï¼‰
- [x] ç¼–è¯‘é˜¶æ®µæ˜¯å¦ç›¸åŒï¼Ÿï¼ˆå†³è®®ï¼šæ˜¯ï¼Œæ‰€æœ‰è¿è¡Œæ—¶å…±äº«åŒä¸€å¥—å‰ç«¯ï¼‰
- [x] è°ƒåº¦å™¨è„±è€¦æ˜¯å¦éœ€è¦ Traitï¼Ÿï¼ˆå†³è®®ï¼š**ä¸éœ€è¦**ï¼Œä½¿ç”¨ YaoXiang æ³›å‹ç›´æ¥å®ç°ï¼‰
- [x] è¿è¡Œæ—¶åˆ‡æ¢æœºåˆ¶è®¾è®¡ï¼ˆå†³è®®ï¼šæ³›å‹ + æ¡ä»¶ç¼–è¯‘ + å‘ä¸‹åˆ‡æ¢ï¼‰
- [x] æ³›å‹ç±»å‹çº¦æŸ `[S: Scheduler]`ï¼ˆå†³è®®ï¼šå¼€æ–° RFC è®¨è®ºï¼‰
- [x] **è¿è¡Œæ—¶åˆ‡æ¢ API**ï¼šè¿è¡Œæ—¶åˆ‡æ¢åœ¨æ ‡å‡†åº“å†…å®ç°
- [x] **å•çº¿ç¨‹æ¨¡å¼ä¼˜åŒ–**ï¼šDAG æœ¬èº«å°±æ˜¯é¢å¤–å¼€é”€ï¼Œnum_workers=1 ä¸ >=1 æ—¶å¼€é”€ä¸€è‡´
- [x] **è°ƒåº¦æ¨¡å¼åˆ‡æ¢**ï¼šnum_workers åˆ‡æ¢æ—¶è‡ªåŠ¨å¢åŠ è°ƒåº¦å™¨æ ¸å¿ƒï¼ŒåŒæ­¥/å¼‚æ­¥/å¹¶è¡Œè¯­æ³•æ— åŒºåˆ«ï¼Œç”±è°ƒåº¦å™¨è‡ªåŠ¨å¤„ç†
- [x] **æƒ°æ€§æ±‚å€¼æ ‡è®°**ï¼šç¼–è¯‘å™¨è‡ªåŠ¨å¤„ç†ï¼Œç¡®å®šæ— é«˜çº§è¿è¡Œæ—¶å‚ä¸æ—¶ç®€åŒ–ç¼–è¯‘äº§ç‰©ï¼ˆåˆ é™¤æ— ç”¨æ ‡è®°ï¼‰


# å¾…è®¨è®ºé—®é¢˜

> **è¯´æ˜**ï¼šä»¥ä¸‹é—®é¢˜åº”åœ¨å…¶ä»– RFC è®¨è®ºï¼Œä¸åœ¨æœ¬ RFC èŒƒå›´å†…ï¼š
> - æ³›å‹ç±»å‹çº¦æŸè¯­æ³• â†’ æ–° RFC è®¨è®ºï¼ˆå·²å†³è®®ï¼‰
> - @block API è®¾è®¡ â†’ RFC-001 æˆ–æ ‡å‡†åº“ RFC
> - å¼‚å¸¸/é”™è¯¯ä¼ æ’­ â†’ RFC-001 é”™è¯¯å¤„ç†
> - è°ƒè¯•å™¨æ”¯æŒ â†’ è°ƒè¯•å™¨ RFC
> - æ€§èƒ½åŸºå‡† â†’ å®ç°æ–‡æ¡£

- æš‚æ— 

---

## é™„å½•Aï¼šè®¾è®¡è®¨è®ºè®°å½•

### è®¨è®º 1ï¼š@block ä¸å¼‚æ­¥å®ç°ä½ç½®

> **è®¨è®ºçŠ¶æ€**: å·²è§£å†³
> **å‘èµ·è€…**: æ™¨ç…¦
> **æ—¥æœŸ**: 2025-01-05

#### é—®é¢˜æè¿°

å¼‚æ­¥æ”¯æŒæ˜¯å¦éœ€è¦åœ¨ Core Runtime å®ç°ï¼Ÿ@block æ³¨è§£åº”è¯¥æ”¾åœ¨å“ªä¸€å±‚ï¼Ÿ

#### å¤‡é€‰æ–¹æ¡ˆ

| æ–¹æ¡ˆ | æè¿° | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|------|
| A | @block æ˜¯è¯­è¨€å†…ç½® | ç”¨æˆ·å‹å¥½ | å¢åŠ è¯­è¨€å¤æ‚åº¦ |
| B | @block åœ¨ Core Runtime | æ€§èƒ½å¥½ | Core Runtime è†¨èƒ€ |
| C | @block ç”±æ ‡å‡†åº“æä¾› | è§£è€¦ã€çµæ´» | éœ€è¦å¯¼å…¥ |

#### è®¨è®ºè®°å½•

- 2025-01-05 @æ™¨ç…¦ï¼šå¼‚æ­¥æ”¯æŒæœ¬èº«æ ¸å¿ƒçš„ DAG ä¾èµ–å›¾å°±å¯ä»¥æ”¯æŒäº†
- 2025-01-05 @æ™¨ç…¦ï¼šnum_workers=1 æ—¶è‡ªåŠ¨è¿›è¡Œå¼‚æ­¥è°ƒåº¦ï¼Œå¤šçº¿ç¨‹æƒ…å†µä¸‹è‡ªåŠ¨å¹¶å‘è°ƒåº¦
- 2025-01-05 @æ™¨ç…¦ï¼šåŒä¸€ä¸ªæ ¸å¿ƒä¸Šä¹Ÿèƒ½å¼‚æ­¥ï¼Œä¿æŒä¸åŒæ­¥è¯­ä¹‰ä¸€è‡´
- 2025-01-05 @æ™¨ç…¦ï¼š@block ç”±æ ‡å‡†åº“æä¾›ï¼Œå¼ºåˆ¶å‡½æ•°å†…çš„æ‰€æœ‰è¯­å¥æ€¥åˆ‡æ±‚å€¼ï¼Œè¡¨ç°ä¸ºåŒæ­¥

#### å†³è®®

é‡‡ç”¨æ–¹æ¡ˆ Cï¼š
- âœ… å¼‚æ­¥æ”¯æŒç”± DAG å¤©ç„¶æ”¯æŒï¼Œåœ¨ Core Runtime
- âœ… @block ç”±æ ‡å‡†åº“æä¾›ï¼Œä¸åœ¨è¯­è¨€å†…ç½®
- âœ… ä¿æŒ Core Runtime ç®€æ´

---

### è®¨è®º 2ï¼šWorkStealer ä½ç½®

> **è®¨è®ºçŠ¶æ€**: å·²è§£å†³
> **å‘èµ·è€…**: æ™¨ç…¦
> **æ—¥æœŸ**: 2025-01-05

#### é—®é¢˜æè¿°

WorkStealer åº”è¯¥æ”¾åœ¨ Core Runtime è¿˜æ˜¯ Full Runtimeï¼Ÿ

#### å¤‡é€‰æ–¹æ¡ˆ

| æ–¹æ¡ˆ | æè¿° | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|------|
| A | WorkStealer åœ¨ Core Runtime | è´Ÿè½½å‡è¡¡è‡ªåŠ¨å¯ç”¨ | Core Runtime è†¨èƒ€ |
| B | WorkStealer åœ¨ Full Runtime | æ ¸å¿ƒç®€æ´ | éœ€è¦å¯ç”¨ç‰¹æ€§ |

#### è®¨è®ºè®°å½•

- 2025-01-05 @æ™¨ç…¦ï¼šå·¥ä½œçªƒå–å¯ä»¥ä½œä¸º num_workers>1 ä¹‹åçš„é«˜çº§ç‰¹æ€§

#### å†³è®®

é‡‡ç”¨æ–¹æ¡ˆ Bï¼š
- âœ… WorkStealer æ˜¯ num_workers>1 æ—¶çš„è´Ÿè½½å‡è¡¡ç­–ç•¥
- âœ… ä¸åœ¨ Core Runtimeï¼Œä½œä¸º Full Runtime å¯é€‰ç‰¹æ€§
- âœ… Core Runtime åœ¨ num_workers=1 æ—¶ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œ

---

### è®¨è®º 3ï¼šè°ƒåº¦å™¨è„±è€¦æ–¹æ¡ˆé€‰æ‹©

> **è®¨è®ºçŠ¶æ€**: å·²è§£å†³
> **å‘èµ·è€…**: æ™¨ç…¦
> **æ—¥æœŸ**: 2025-01-05
> **æ›´æ–°**: 2025-01-05 - ä¿®æ­£ä¸ºã€Œæ³›å‹ + æ³¨å…¥ã€æ–¹æ¡ˆ C'

#### é—®é¢˜æè¿°

å¦‚ä½•è®¾è®¡è°ƒåº¦å™¨ï¼Œä½¿å…¶åœ¨ä¸å¯ç”¨å·¥ä½œçªƒå–æ—¶ï¼Œè§£é‡Šå™¨ä»èƒ½æ­£å¸¸è¿è¡Œï¼ŸåŒæ—¶ï¼ŒYaoXiang è¯­è¨€æœ¬èº«æ”¯æŒæ³›å‹ï¼Œæ˜¯å¦å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹é¿å…å¼•å…¥ Trait æ¦‚å¿µï¼Ÿ

#### å¤‡é€‰æ–¹æ¡ˆ

| æ–¹æ¡ˆ | æè¿° | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|------|
| A: æ¡ä»¶ç¼–è¯‘ | #[cfg] æ§åˆ¶ä»£ç è·¯å¾„ | é›¶è¿è¡Œæ—¶å¼€é”€ | ç»´æŠ¤ä¸¤ä»½ä»£ç  |
| B: è¿è¡Œæ—¶åˆ†æ”¯ | if enabled { ... } else { ... } | å•äºŒè¿›åˆ¶ | ä¸€ç‚¹å¼€é”€ |
| C: Trait + æ³¨å…¥ | æ³¨å…¥ä¸åŒå®ç° | æ¸…æ™°è§£è€¦ | éœ€è¦ Trait å®šä¹‰ |
| **C': æ³›å‹ + æ³¨å…¥** | **ä½¿ç”¨ YaoXiang æ³›å‹å‚æ•°** | **æ¸…æ™°è§£è€¦ã€å•äºŒè¿›åˆ¶ã€é›¶å¼€é”€ã€æ— éœ€ Trait** | **ç¼–è¯‘æœŸç¡®å®šç±»å‹** |

#### è®¨è®ºè®°å½•

- 2025-01-05 @æ²«éƒé…±ï¼šå»ºè®®ä½¿ç”¨æ–¹æ¡ˆ Cï¼ˆTrait + æ³¨å…¥ï¼‰ï¼Œå› ä¸ºæœ€æ¸…æ™°ä¸”å•äºŒè¿›åˆ¶
- 2025-01-05 @æ™¨ç…¦ï¼šåŒæ„æ–¹æ¡ˆ C
- 2025-01-05 @æ™¨ç…¦ï¼š**å…³é”®æ´å¯Ÿ**ï¼šæˆ‘çš„è¯­è¨€æ”¯æŒæ³›å‹ï¼Œæˆ‘ç›´æ¥ç”¨æ³›å‹å®ç°ä¸å°±è¡Œäº†ï¼
- 2025-01-05 @æ²«éƒé…±ï¼šå¯¹å‘€ï¼è¿™æ ·å°±ä¸éœ€è¦ Trait äº†å–µï½ä½¿ç”¨æ³›å‹å‚æ•° `[S]` å®ç°è°ƒåº¦å™¨è„±è€¦

#### å†³è®®

é‡‡ç”¨æ–¹æ¡ˆ C'ï¼ˆ**æ³›å‹ + æ³¨å…¥**ï¼‰ï¼š
- âœ… æ¸…æ™°è§£è€¦
- âœ… å•äºŒè¿›åˆ¶æ”¯æŒå¤šç§æ¨¡å¼
- âœ… æ— æ¡ä»¶ç¼–è¯‘å¤æ‚åº¦
- âœ… **é›¶è¿è¡Œæ—¶å¼€é”€**ï¼ˆç¼–è¯‘æœŸå¤šæ€ï¼‰
- âœ… **æ— éœ€ Trait æ¦‚å¿µ**ï¼ˆåˆ©ç”¨ YaoXiang æ³›å‹ï¼‰
- âœ… è°ƒåº¦å™¨ç±»å‹åœ¨ç¼–è¯‘æœŸç¡®å®šï¼Œè¿è¡Œæ—¶æ— å¼€é”€
- âš ï¸ **å¾…è¯­è¨€æ‰©å±•**ï¼šYaoXiang å½“å‰ä¸æ”¯æŒæ³›å‹ç±»å‹çº¦æŸï¼ˆå¦‚ `S: Scheduler`ï¼‰

---

### è®¨è®º 4ï¼šåµŒå…¥å¼è¿è¡Œæ—¶è®¾è®¡

> **è®¨è®ºçŠ¶æ€**: å·²è§£å†³
> **å‘èµ·è€…**: æ™¨ç…¦
> **æ—¥æœŸ**: 2025-01-05

#### é—®é¢˜æè¿°

åµŒå…¥å¼åœºæ™¯ï¼ˆå¦‚ WASM/æ¸¸æˆè„šæœ¬ï¼‰éœ€è¦ä»€ä¹ˆè¿è¡Œæ—¶æ”¯æŒï¼Ÿæ˜¯å¦éœ€è¦ DAG è°ƒåº¦ï¼Ÿ

#### å¤‡é€‰æ–¹æ¡ˆ

| æ–¹æ¡ˆ | æè¿° | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|------|
| A | åµŒå…¥å¼ä½¿ç”¨ Standard Runtime | ä»£ç å¤ç”¨ã€ç‰¹æ€§å®Œæ•´ | å†…å­˜å ç”¨é«˜ã€å¯åŠ¨æ…¢ |
| B | åµŒå…¥å¼ä½¿ç”¨å³æ—¶æ‰§è¡Œå™¨ï¼Œæ—  DAG | é«˜æ€§èƒ½ã€ä½å ç”¨ã€å¿«é€Ÿå¯åŠ¨ | æ”¾å¼ƒæƒ°æ€§æ±‚å€¼ã€æ”¾å¼ƒå¹¶å‘ |
| C | åµŒå…¥å¼å¯é€‰å¯ç”¨ DAG | çµæ´» | å¢åŠ å¤æ‚åº¦ |

#### è®¨è®ºè®°å½•

- 2025-01-05 @æ™¨ç…¦ï¼šåµŒå…¥å¼éœ€è¦é«˜æ€§èƒ½å’Œä½å†…å­˜å ç”¨
- 2025-01-05 @æ™¨ç…¦ï¼šYaoXiang æ˜¯ç¼–è¯‘å‹è¯­è¨€ï¼Œç¼–è¯‘é˜¶æ®µå®Œå…¨ç›¸åŒ
- 2025-01-05 @æ™¨ç…¦ï¼šåµŒå…¥å¼åœºæ™¯ä½¿ç”¨å³æ—¶æ‰§è¡Œå™¨ï¼ŒæŒ‰é¡ºåºåŒæ­¥æ‰§è¡Œ
- 2025-01-05 @æ™¨ç…¦ï¼šè™½ç„¶ä»£ç æ ‡è®°äº†æƒ°æ€§æ±‚å€¼ï¼Œä½†åµŒå…¥å¼æ²¡æœ‰è°ƒåº¦å™¨ï¼Œé»˜è®¤åŒæ­¥æ‰§è¡Œ
- 2025-01-05 @æ²«éƒé…±ï¼šç¼–è¯‘é˜¶æ®µå®Œå…¨ç›¸åŒï¼ŒåŒºåˆ«ä»…åœ¨è¿è¡Œæ—¶æ‰§è¡Œæ–¹å¼

#### å†³è®®

é‡‡ç”¨æ–¹æ¡ˆ Bï¼š
- âœ… ç¼–è¯‘é˜¶æ®µå®Œå…¨ç›¸åŒï¼ˆå…±äº«åŒä¸€å¥—å‰ç«¯ï¼‰
- âœ… åµŒå…¥å¼ä½¿ç”¨å³æ—¶æ‰§è¡Œå™¨ï¼ŒæŒ‰é¡ºåºåŒæ­¥æ‰§è¡Œ
- âœ… åµŒå…¥å¼æ”¾å¼ƒ DAG è°ƒåº¦ï¼Œè·å¾—é«˜æ€§èƒ½ + ä½å ç”¨ + å¿«é€Ÿå¯åŠ¨
- âœ… åµŒå…¥å¼æ”¾å¼ƒæƒ°æ€§æ±‚å€¼å’Œè‡ªåŠ¨å¹¶å‘
- âœ… ç›®æ ‡åœºæ™¯ï¼šWASM / æ¸¸æˆè„šæœ¬ / è§„åˆ™å¼•æ“ / æ•°æ®åº“å­˜å‚¨è¿‡ç¨‹

---

### è®¨è®º 5ï¼šå•çº¿ç¨‹æ¨¡å¼å®ç°

> **è®¨è®ºçŠ¶æ€**: å·²è§£å†³
> **å‘èµ·è€…**: æ²«éƒé…±
> **æ—¥æœŸ**: 2025-01-05

#### é—®é¢˜æè¿°

å¦‚ä½•æ­£ç¡®å®ç°"å•çº¿ç¨‹æ¨¡å¼"ï¼Ÿæ˜¯ç¦ç”¨è°ƒåº¦å™¨è¿˜æ˜¯ä½¿ç”¨å• Workerï¼Ÿ

#### å¤‡é€‰æ–¹æ¡ˆ

| æ–¹æ¡ˆ | æè¿° | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|------|
| A: ç¦ç”¨è°ƒåº¦å™¨ | scheduler.disabled = true | ç®€å• | ç ´åæ¶æ„ä¸€è‡´æ€§ |
| B: å• Worker | scheduler = SingleThreadScheduler | ä¸€è‡´æ€§å¥½ | éœ€è¦å•ç‹¬å®ç° |

#### è®¨è®ºè®°å½•

- 2025-01-05 @æ²«éƒé…±ï¼šå»ºè®®æ–¹æ¡ˆ Bï¼ŒåŒæ­¥åªæ˜¯è°ƒåº¦çš„ç‰¹ä¾‹
- 2025-01-05 @æ™¨ç…¦ï¼šåŒæ„ï¼åŒæ­¥åªæ˜¯è°ƒåº¦çš„ç‰¹ä¾‹
- 2025-01-05 @æ™¨ç…¦ï¼šå•çº¿ç¨‹æ¨¡å¼ä¸‹çš„å¹¶å‘åº”è¯¥è¡¨ç°ä¸ºå¼‚æ­¥

#### å†³è®®

é‡‡ç”¨æ–¹æ¡ˆ Bï¼š
- âœ… åŒæ­¥åªæ˜¯è°ƒåº¦çš„ç‰¹ä¾‹
- âœ… å•çº¿ç¨‹æ¨¡å¼ä¸‹å¹¶å‘è¡¨ç°ä¸ºå¼‚æ­¥
- âœ… è°ƒåº¦å™¨å§‹ç»ˆå­˜åœ¨ï¼Œåªæ˜¯é…ç½®ä¸åŒ
- âœ… ä¿æŒæ¶æ„ä¸€è‡´æ€§

---

### è®¨è®º 6ï¼šè¿è¡Œæ—¶åˆ‡æ¢æœºåˆ¶è®¾è®¡

> **è®¨è®ºçŠ¶æ€**: å·²è§£å†³
> **å‘èµ·è€…**: æ™¨ç…¦
> **æ—¥æœŸ**: 2025-01-05

#### é—®é¢˜æè¿°

è¿è¡Œæ—¶åˆ‡æ¢æ˜¯å¦æ”¯æŒæ³›å‹ç±»å‹çš„æ¡ä»¶ç¼–è¯‘ï¼Ÿå¦‚ä½•è®¾è®¡ä¸‰å±‚è¿è¡Œæ—¶çš„åˆ‡æ¢æœºåˆ¶ï¼Ÿ

#### å¤‡é€‰æ–¹æ¡ˆ

| æ–¹æ¡ˆ | æè¿° | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|------|
| A: æ¡ä»¶ç¼–è¯‘ | é€šè¿‡ `#[cfg]` æ§åˆ¶ä»£ç è·¯å¾„ | é›¶è¿è¡Œæ—¶å¼€é”€ | éœ€è¦ä¸ºæ¯ç§æ¨¡å¼ç¼–è¯‘ä¸åŒç‰ˆæœ¬ |
| B: è¿è¡Œæ—¶åˆ†æ”¯ | if runtime_mode == Full { ... } | å•äºŒè¿›åˆ¶ | ä¸€ç‚¹è¿è¡Œæ—¶å¼€é”€ |
| C: æ³›å‹ + æ¡ä»¶ç¼–è¯‘ + å‘ä¸‹åˆ‡æ¢ | ç¼–è¯‘æ—¶é€‰æ‹©å±‚çº§ï¼Œè¿è¡Œæ—¶é€‰æ‹©æ€§ç¦ç”¨ | çµæ´»ã€å¯æ‰©å±• | å®ç°å¤æ‚åº¦è¾ƒé«˜ |

#### è®¨è®ºè®°å½•

- 2025-01-05 @æ™¨ç…¦ï¼šè¿è¡Œæ—¶åˆ‡æ¢æ˜¯ä¸æ˜¯ä¸æ”¯æŒæ³›å‹ç±»å‹çš„æ¡ä»¶ç¼–è¯‘ï¼Œéœ€è¦å¯¼è‡´ä¸‰å±‚å…¨éƒ¨ç¼–è¯‘ï¼Ÿ
- 2025-01-05 @æ™¨ç…¦ï¼šè®¾è®¡ä¸ºé€šè¿‡æ³›å‹åˆ¤æ–­éœ€è¦ç¼–è¯‘å‡ å±‚ï¼Œæä¾›è¿è¡Œæ—¶å‘ä¸‹åˆ‡æ¢çš„é€‰å‹
- 2025-01-05 @æ™¨ç…¦ï¼šæ¯”å¦‚ç¼–è¯‘äº§ç”Ÿæ ‡å‡†è¿è¡Œæ—¶å¯ä»¥åˆ‡æ¢ä¸ºåµŒå…¥å¼ï¼Œä½†æ˜¯ç”±äºæ²¡æœ‰æ¥å…¥å®Œæ•´è¿è¡Œæ—¶ï¼Œæ— æ³•åˆ‡æ¢ä¸ºå®Œæ•´è¿è¡Œæ—¶
- 2025-01-05 @æ™¨ç…¦ï¼šç¼–è¯‘æ—¶æ ‡è®°ä¿ç•™ï¼Œä½¿ä¹‹æ”¯æŒè¿è¡Œæ—¶å‘ä¸‹åˆ‡æ¢è¿˜èƒ½åˆ‡æ¢å›å»

#### è¿è¡Œæ—¶åˆ‡æ¢è§„åˆ™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    è¿è¡Œæ—¶å‘ä¸‹åˆ‡æ¢è§„åˆ™                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  Full       â”‚â”€â”€â”€â–¶â”‚  Standard   â”‚â”€â”€â”€â–¶â”‚  Embedded   â”‚        â”‚
â”‚  â”‚  å®Œæ•´è¿è¡Œæ—¶  â”‚    â”‚  æ ‡å‡†è¿è¡Œæ—¶  â”‚    â”‚  åµŒå…¥å¼è¿è¡Œæ—¶â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚       â”‚                   â”‚                   â”‚                 â”‚
â”‚       â–¼                   â–¼                   â–¼                 â”‚
â”‚    âœ… Full           âœ… Standard           âœ… Embedded         â”‚
â”‚    âœ… Standard       âœ… Standard           âœ… Embedded         â”‚
â”‚    âŒ Embedded       âŒ Embedded           âœ… Embedded         â”‚
â”‚                                                                 â”‚
â”‚  åˆ‡æ¢è§„åˆ™ï¼š                                                          â”‚
â”‚  â”œâ”€â”€ Full â†’ Standardï¼šå¯ç”¨æ ‡å‡†è°ƒåº¦ï¼Œç¦ç”¨ WorkStealer              â”‚
â”‚  â”œâ”€â”€ Full â†’ Embeddedï¼šå¯ç”¨å³æ—¶æ‰§è¡Œï¼Œç¦ç”¨ DAG å’Œè°ƒåº¦å™¨              â”‚
â”‚  â”œâ”€â”€ Standard â†’ Embeddedï¼šå¯ç”¨å³æ—¶æ‰§è¡Œï¼Œç¦ç”¨ DAG                   â”‚
â”‚  â””â”€â”€ **å‘ä¸Šåˆ‡æ¢ä¸å¯èƒ½**ï¼šEmbedded æ— æ³•åˆ‡æ¢åˆ° Standard æˆ– Full     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### å†³è®®

é‡‡ç”¨æ–¹æ¡ˆ Cï¼ˆ**æ³›å‹ + æ¡ä»¶ç¼–è¯‘ + å‘ä¸‹åˆ‡æ¢**ï¼‰ï¼š
- âœ… é€šè¿‡æ³›å‹åˆ¤æ–­éœ€è¦ç¼–è¯‘å‡ å±‚
- âœ… æä¾›è¿è¡Œæ—¶å‘ä¸‹åˆ‡æ¢çš„é€‰å‹
- âœ… ç¼–è¯‘äº§ç”Ÿ Standard è¿è¡Œæ—¶å¯åˆ‡æ¢ä¸º Embeddedï¼Œä½†æ— æ³•åˆ‡æ¢ä¸º Full
- âœ… ç¼–è¯‘æ—¶æ ‡è®°ä¿ç•™ï¼ˆDAG æ ‡è®°ï¼‰ï¼Œæ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢
- âœ… å‘ä¸‹åˆ‡æ¢åå¯éšæ—¶å†å¯ç”¨ï¼ˆå¦‚ Standard â†’ Embedded åå¯åˆ‡å› Standardï¼‰

---

### è®¨è®º 7ï¼šæ³›å‹ç±»å‹çº¦æŸä¸è°ƒåº¦å™¨æ¥å£æ ‡å‡†åŒ–

> **è®¨è®ºçŠ¶æ€**: å·²è§£å†³
> **å‘èµ·è€…**: æ™¨ç…¦
> **æ—¥æœŸ**: 2025-01-05

#### é—®é¢˜æè¿°

1. `[S: Scheduler]` ç±»å‹çº¦æŸè¯­æ³•æ˜¯å¦éœ€è¦åŠ å…¥è¯­è¨€è§„èŒƒï¼Ÿ
2. è°ƒåº¦å™¨æ¥å£çš„æ ‡å‡†åŒ–åº”è¯¥åœ¨å“ªä¸ª RFC è®¨è®ºï¼Ÿ

#### è®¨è®ºè®°å½•

- 2025-01-05 @æ™¨ç…¦ï¼šä¸æ”¯æŒç±»å‹çº¦æŸ `S: Scheduler` æ˜¯å¦è¦å¼€ä¸€ä¸ªæ–°çš„ RFC æ¥è®¨è®ºï¼Ÿ
- 2025-01-05 @æ™¨ç…¦ï¼šæˆ‘å€’æ˜¯å¾ˆæƒ³è¿›è¡Œæ”¯æŒï¼Œæ¯•ç«Ÿä¸€åˆ‡çš†æ˜¯ç±»å‹
- 2025-01-05 @æ™¨ç…¦ï¼šè°ƒåº¦å™¨æ¥å£æ ‡å‡†åŒ–åœ¨ RFC-003 è®¨è®º

#### å†³è®®

- âœ… **æ³›å‹ç±»å‹çº¦æŸ**ï¼šéœ€è¦å¼€æ–° RFC è®¨è®º `[S: Scheduler]` è¯­æ³•
- âœ… **è°ƒåº¦å™¨æ¥å£æ ‡å‡†åŒ–**ï¼šç§»åˆ° RFC-003 ç‰ˆæœ¬è§„åˆ’ä¸­è®¨è®º
- âœ… éµå¾ª"ä¸€åˆ‡çš†æ˜¯ç±»å‹"çš„è®¾è®¡å“²å­¦

---

### è®¨è®º 8ï¼šè¿è¡Œæ—¶åˆ‡æ¢ä¸åµŒå…¥å¼ç¼–è¯‘äº§ç‰©å¤„ç†

> **è®¨è®ºçŠ¶æ€**: å·²è§£å†³
> **å‘èµ·è€…**: æ™¨ç…¦
> **æ—¥æœŸ**: 2025-01-05

#### é—®é¢˜æè¿°

1. è¿è¡Œæ—¶åˆ‡æ¢åº”è¯¥åœ¨è¯­è¨€å±‚é¢è¿˜æ˜¯æ ‡å‡†åº“å®ç°ï¼Ÿ
2. DAG åœ¨å•çº¿ç¨‹æ¨¡å¼ä¸‹çš„å¼€é”€å¦‚ä½•ï¼Ÿ
3. åŒæ­¥/å¼‚æ­¥/å¹¶è¡Œå¦‚ä½•å¹³æ»‘åˆ‡æ¢ï¼Ÿ
4. åµŒå…¥å¼æ¨¡å¼ä¸‹ç¼–è¯‘äº§ç‰©å¦‚ä½•å¤„ç†ï¼Ÿ

#### è®¨è®ºè®°å½•

- 2025-01-05 @æ™¨ç…¦ï¼šè¿è¡Œæ—¶åˆ‡æ¢å¯ä»¥åœ¨æ ‡å‡†åº“å†…å®ç°
- 2025-01-05 @æ™¨ç…¦ï¼šDAG åœ¨ num_workers=1 æ—¶æ˜¯å¦æœ‰é¢å¤–å¼€é”€ï¼Ÿå®é™…ä¸Š DAG æœ¬èº«å°±æ˜¯é¢å¤–å¼€é”€ï¼Œå¼€é”€æƒ…å†µå’Œ num_workers>=1 æ—¶ä¸€è‡´
- 2025-01-05 @æ™¨ç…¦ï¼šå•çº¿ç¨‹å¼‚æ­¥ä¸å¤šçº¿ç¨‹å¹¶è¡Œå¦‚ä½•å¹³æ»‘åˆ‡æ¢ï¼Ÿåœ¨ num_workers åˆ‡æ¢æ—¶è‡ªåŠ¨å°†è°ƒåº¦å™¨çš„æ ¸å¿ƒå¢åŠ ï¼Œå¼€å§‹å¹¶è¡Œå¤„ç†ä»»åŠ¡
- 2025-01-05 @æ™¨ç…¦ï¼šåœ¨æˆ‘ä»¬è¯­è¨€çš„è¯­å¢ƒä¸‹é¢ï¼ŒåŒæ­¥ï¼Œå¼‚æ­¥ï¼Œå¹¶è¡Œè¯­æ³•æ²¡æœ‰åŒºåˆ«ï¼Œç”±è°ƒåº¦å™¨è§£å†³
- 2025-01-05 @æ™¨ç…¦ï¼šåµŒå…¥å¼æ¨¡å¼ä¸‹ç¼–è¯‘äº§ç‰©å¯ä»¥ç®€åŒ–ï¼Œåˆ é™¤æ— ç”¨æ ‡è®°ï¼Œä½†æ˜¯è¯­æ³•è§£æå’Œä»£ç å±‚é¢ä¸ç”¨åšä»»ä½•æ”¹å˜ï¼Œè¿™ä¸€åˆ‡éƒ½æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨å¤„ç†

#### å†³è®®

- âœ… **è¿è¡Œæ—¶åˆ‡æ¢**ï¼šåœ¨æ ‡å‡†åº“å†…å®ç°
- âœ… **DAG å¼€é”€**ï¼šDAG æœ¬èº«å°±æ˜¯é¢å¤–å¼€é”€ï¼Œä¸ num_workers æ— å…³
- âœ… **è°ƒåº¦æ¨¡å¼åˆ‡æ¢**ï¼šnum_workers åˆ‡æ¢æ—¶è‡ªåŠ¨è°ƒæ•´ï¼ŒåŒæ­¥/å¼‚æ­¥/å¹¶è¡Œè¯­æ³•æ— åŒºåˆ«ï¼Œç”±è°ƒåº¦å™¨è‡ªåŠ¨å¤„ç†
- âœ… **ç¼–è¯‘äº§ç‰©ç®€åŒ–**ï¼šç¼–è¯‘å™¨è‡ªåŠ¨å¤„ç†ï¼Œç¡®å®šæ— é«˜çº§è¿è¡Œæ—¶å‚ä¸æ—¶åˆ é™¤æ— ç”¨æ ‡è®°
- âœ… **ä¾èµ–å›¾æ„å»º**ï¼šé™æ€ä¾èµ–å›¾ï¼Œç¼–è¯‘æœŸç¡®å®šæ‰€æœ‰ä¾èµ–ï¼Œè¿è¡Œæ—¶æ— é¢å¤–è´Ÿæ‹…ï¼ˆå†…å­˜æ¢æ€§èƒ½ï¼‰
- âœ… **Task ç”Ÿå‘½å‘¨æœŸ**ï¼šç§»åˆ° RFC-001 å¹¶ä½œæ¨¡å‹ä¸­è®¨è®º

---

## é™„å½•Bï¼šè®¾è®¡å†³ç­–è®°å½•

| å†³ç­– | å†³å®š | æ—¥æœŸ | è®°å½•äºº |
|------|------|------|--------|
| è°ƒåº¦å™¨è„±è€¦æ–¹æ¡ˆ | **æ³›å‹ + æ³¨å…¥**ï¼ˆæ–¹æ¡ˆ C'ï¼‰ | 2025-01-05 | æ™¨ç…¦ã€æ²«éƒé…± |
| å•çº¿ç¨‹æ¨¡å¼ | åŒæ­¥æ˜¯è°ƒåº¦çš„ç‰¹ä¾‹ï¼ˆæ–¹æ¡ˆ Bï¼‰ | 2025-01-05 | æ²«éƒé…±ã€æ™¨ç…¦ |
| å¼‚æ­¥å®ç° | DAG å¤©ç„¶æ”¯æŒ | 2025-01-05 | æ™¨ç…¦ |
| @block | æ ‡å‡†åº“æä¾› | 2025-01-05 | æ™¨ç…¦ |
| WorkStealer | Full Runtime é«˜çº§ç‰¹æ€§ | 2025-01-05 | æ™¨ç…¦ |
| å¹¶å‘å±‚çº§ | L1: Full Runtime, L2-L3: Standard Runtime | 2025-01-05 | æ²«éƒé…± |
| åµŒå…¥å¼è®¾è®¡ | å³æ—¶æ‰§è¡Œï¼Œæ—  DAG è°ƒåº¦ | 2025-01-05 | æ™¨ç…¦ |
| ç¼–è¯‘é˜¶æ®µ | æ‰€æœ‰è¿è¡Œæ—¶å…±äº«åŒä¸€å¥—å‰ç«¯ | 2025-01-05 | æ™¨ç…¦ |
| è¿è¡Œæ—¶åˆ†å±‚ | Embedded / Standard / Full ä¸‰å±‚ | 2025-01-05 | æ²«éƒé…± |
| **ç±»å‹çº¦æŸ RFC** | `[S: Scheduler]` éœ€è¦æ–° RFC è®¨è®º | 2025-01-05 | æ™¨ç…¦ |
| **è°ƒåº¦å™¨æ¥å£** | ç§»åˆ° RFC-003 è®¨è®º | 2025-01-05 | æ™¨ç…¦ |
| **ç¼–è¯‘æ ‡è®°ä¿ç•™** | ä¿ç•™ DAG æ ‡è®°æ”¯æŒè¿è¡Œæ—¶åˆ‡æ¢ | 2025-01-05 | æ™¨ç…¦ |
| **è¿è¡Œæ—¶åˆ‡æ¢** | åœ¨æ ‡å‡†åº“å†…å®ç°ï¼ˆæ³›å‹ + æ¡ä»¶ç¼–è¯‘ + å‘ä¸‹åˆ‡æ¢ï¼‰ | 2025-01-05 | æ™¨ç…¦ |
| **DAG å¼€é”€** | æœ¬èº«å°±æ˜¯é¢å¤–å¼€é”€ï¼Œä¸ num_workers æ— å…³ | 2025-01-05 | æ™¨ç…¦ |
| **è°ƒåº¦æ¨¡å¼åˆ‡æ¢** | num_workers åˆ‡æ¢æ—¶è‡ªåŠ¨è°ƒæ•´ï¼Œç”±è°ƒåº¦å™¨å¤„ç† | 2025-01-05 | æ™¨ç…¦ |
| **ç¼–è¯‘äº§ç‰©ç®€åŒ–** | ç¼–è¯‘å™¨è‡ªåŠ¨å¤„ç†ï¼Œç¡®å®šæ— é«˜çº§è¿è¡Œæ—¶æ—¶åˆ é™¤æ ‡è®° | 2025-01-05 | æ™¨ç…¦ |
| **ä¾èµ–å›¾æ„å»º** | é™æ€ä¾èµ–å›¾ï¼Œç¼–è¯‘æœŸç¡®å®šï¼Œè¿è¡Œæ—¶æ— è´Ÿæ‹…ï¼ˆå†…å­˜æ¢æ€§èƒ½ï¼‰ | 2025-01-05 | æ™¨ç…¦ |

---

## å‚è€ƒæ–‡çŒ®

### YaoXiang å®˜æ–¹æ–‡æ¡£
- [RFC-001: å¹¶ä½œæ¨¡å‹ä¸é”™è¯¯å¤„ç†ç³»ç»Ÿ](../rfc/001-concurrent-model-error-handling.md)
- [RFC-003: ç‰ˆæœ¬è§„åˆ’ä¸å®ç°å»ºè®®](../rfc/003-version-planning.md)
- [è¯­è¨€è§„èŒƒ](../language-spec.md)
- [YaoXiang æŒ‡å—](../guides/YaoXiang-book.md)

### å¤–éƒ¨å‚è€ƒ
- [Rust async è¿è¡Œæ—¶è®¾è®¡](https://tokio.rs/)
- [Go è°ƒåº¦å™¨è®¾è®¡](https://golang.org/src/runtime/proc.go)
- [Swift Actor æ¨¡å‹](https://docs.swift.org/swift-book/LanguageGuide/Concurrency.html)

---

## ç”Ÿå‘½å‘¨æœŸä¸å½’å®¿

| çŠ¶æ€ | ä½ç½® | è¯´æ˜ |
|------|------|------|
| **è‰æ¡ˆ** | `docs/design/rfc/` | ä½œè€…è‰ç¨¿ï¼Œç­‰å¾…æäº¤å®¡æ ¸ |
| **å®¡æ ¸ä¸­** | `docs/design/rfc/` | å¼€æ”¾ç¤¾åŒºè®¨è®ºå’Œåé¦ˆ |
| **å·²æ¥å—** | `docs/design/accepted/` | æˆä¸ºæ­£å¼è®¾è®¡æ–‡æ¡£ |
| **å·²æ‹’ç»** | `docs/design/rfc/` | ä¿ç•™åœ¨RFCç›®å½• |
