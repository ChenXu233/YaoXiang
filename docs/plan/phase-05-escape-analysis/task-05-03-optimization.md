# Task 5.3: 分配优化

> **优先级**: P1
> **状态**: ⏳ 待实现

## 功能描述

根据逃逸分析结果优化内存分配策略。

## 优化策略

| 场景 | 原策略 | 优化后策略 |
|------|--------|------------|
| 局部变量，不逃逸 | 堆分配 | 栈分配 (`alloca`) |
| 返回值，不逃逸 | 堆分配 | 栈分配+返回优化 |
| 循环变量，不逃逸 | 每次迭代堆分配 | 栈分配重用 |
| 被闭包捕获 | 栈分配 | 堆分配+捕获列表 |

## 优化示例

### 栈分配优化
```yaoxiang
# 优化前
fn compute() -> Int {
    x = [1, 2, 3, 4, 5]  # 堆分配
    sum(x)
}

# 优化后
fn compute() -> Int {
    x = alloca [1, 2, 3, 4, 5]  # 栈分配
    sum(x)
}
```

### 循环优化
```yaoxiang
# 优化前
for i in 0..1000 {
    buf = [0; 1024]  # 每次迭代堆分配
    process(buf)
}

# 优化后
buf = alloca [0; 1024]  # 栈分配一次
for i in 0..1000 {
    clear(buf)
    process(buf)
}
```

## 相关文件

- **optimizer.rs**: 优化器实现
